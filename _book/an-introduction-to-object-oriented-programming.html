<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 An Introduction to Object-Oriented Programming | An Introduction to R and Python For Data Analysis: A Side By Side Approach</title>
  <meta name="description" content="Chapter 14 An Introduction to Object-Oriented Programming | An Introduction to R and Python For Data Analysis: A Side By Side Approach" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 An Introduction to Object-Oriented Programming | An Introduction to R and Python For Data Analysis: A Side By Side Approach" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="tbrown122387/r_and_python_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 An Introduction to Object-Oriented Programming | An Introduction to R and Python For Data Analysis: A Side By Side Approach" />
  
  
  

<meta name="author" content="Taylor R. Brown" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="visualization.html"/>
<link rel="next" href="an-introduction-to-functional-programming.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Introduction to R and Python For Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#teaching-a-course-with-this-textbook"><i class="fa fa-check"></i>Teaching a Course With This Textbook</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#licenses"><i class="fa fa-check"></i>License(s)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#about-this-book"><i class="fa fa-check"></i>About this book</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#conventions"><i class="fa fa-check"></i>Conventions</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#installing-the-required-software"><i class="fa fa-check"></i>Installing the Required Software</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#installing-r-and-rstudio"><i class="fa fa-check"></i>Installing R (and RStudio)</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#installing-python-by-installing-anaconda"><i class="fa fa-check"></i>Installing Python by Installing Anaconda</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Introducing the Basics</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#hello-world-in-r"><i class="fa fa-check"></i><b>1.1</b> Hello World in R</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#hello-world-in-python"><i class="fa fa-check"></i><b>1.2</b> Hello World in Python</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#getting-help"><i class="fa fa-check"></i><b>1.3</b> Getting Help</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#reading-documentation"><i class="fa fa-check"></i><b>1.3.1</b> Reading Documentation</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#understanding-file-paths"><i class="fa fa-check"></i><b>1.3.2</b> Understanding File Paths</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basic-types.html"><a href="basic-types.html"><i class="fa fa-check"></i><b>2</b> Basic Types</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basic-types.html"><a href="basic-types.html#basic-types-in-python"><i class="fa fa-check"></i><b>2.1</b> Basic Types In Python</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="basic-types.html"><a href="basic-types.html#type-conversions-in-python"><i class="fa fa-check"></i><b>2.1.1</b> Type Conversions in Python</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="basic-types.html"><a href="basic-types.html#basic-types-in-r"><i class="fa fa-check"></i><b>2.2</b> Basic Types In R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="basic-types.html"><a href="basic-types.html#type-conversions-in-r"><i class="fa fa-check"></i><b>2.2.1</b> Type Conversions in R</a></li>
<li class="chapter" data-level="2.2.2" data-path="basic-types.html"><a href="basic-types.html#rs-simplification"><i class="fa fa-check"></i><b>2.2.2</b> R’s Simplification</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="basic-types.html"><a href="basic-types.html#exercises"><i class="fa fa-check"></i><b>2.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="basic-types.html"><a href="basic-types.html#r-questions"><i class="fa fa-check"></i><b>2.3.1</b> R Questions</a></li>
<li class="chapter" data-level="2.3.2" data-path="basic-types.html"><a href="basic-types.html#python-questions"><i class="fa fa-check"></i><b>2.3.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html"><i class="fa fa-check"></i><b>3</b> R <code>vector</code>s versus Numpy <code>array</code>s and Pandas’ <code>Series</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#overview-of-r"><i class="fa fa-check"></i><b>3.1</b> Overview of R</a></li>
<li class="chapter" data-level="3.2" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#overview-of-python"><i class="fa fa-check"></i><b>3.2</b> Overview of Python</a></li>
<li class="chapter" data-level="3.3" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#vectorization-in-r"><i class="fa fa-check"></i><b>3.3</b> Vectorization in R</a></li>
<li class="chapter" data-level="3.4" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#vectorization-in-python"><i class="fa fa-check"></i><b>3.4</b> Vectorization in Python</a></li>
<li class="chapter" data-level="3.5" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#indexing-vectors-in-r"><i class="fa fa-check"></i><b>3.5</b> Indexing Vectors in R</a></li>
<li class="chapter" data-level="3.6" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#indexing-numpy-arrays"><i class="fa fa-check"></i><b>3.6</b> Indexing Numpy arrays</a></li>
<li class="chapter" data-level="3.7" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#indexing-pandas-series"><i class="fa fa-check"></i><b>3.7</b> Indexing Pandas’ Series</a></li>
<li class="chapter" data-level="3.8" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#some-gotchas"><i class="fa fa-check"></i><b>3.8</b> Some Gotchas</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#shallow-versus-deep-copies"><i class="fa fa-check"></i><b>3.8.1</b> Shallow versus Deep Copies</a></li>
<li class="chapter" data-level="3.8.2" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#how-r-and-python-handle-missing-values"><i class="fa fa-check"></i><b>3.8.2</b> How R and Python Handle Missing Values</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#an-introduction-to-regular-expressions"><i class="fa fa-check"></i><b>3.9</b> An Introduction to Regular Expressions</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#literal-characters-versus-metacharacters"><i class="fa fa-check"></i><b>3.9.1</b> Literal Characters versus Metacharacters</a></li>
<li class="chapter" data-level="3.9.2" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#the-trouble-with-backslashes-escape-sequences"><i class="fa fa-check"></i><b>3.9.2</b> The Trouble With Backslashes: Escape Sequences</a></li>
<li class="chapter" data-level="3.9.3" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#more-examples-of-using-regular-expressions"><i class="fa fa-check"></i><b>3.9.3</b> More Examples of Using Regular Expressions</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#exercises-1"><i class="fa fa-check"></i><b>3.10</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#r-questions-1"><i class="fa fa-check"></i><b>3.10.1</b> R Questions</a></li>
<li class="chapter" data-level="3.10.2" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#python-questions-1"><i class="fa fa-check"></i><b>3.10.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><i class="fa fa-check"></i><b>4</b> Numpy <code>ndarray</code>s Versus R’s <code>matrix</code> and <code>array</code> Types</a>
<ul>
<li class="chapter" data-level="4.1" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html#numpy-ndarrays-in-python"><i class="fa fa-check"></i><b>4.1</b> Numpy <code>ndarray</code>s In Python</a></li>
<li class="chapter" data-level="4.2" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html#the-matrix-and-array-classes-in-r"><i class="fa fa-check"></i><b>4.2</b> The <code>matrix</code> and <code>array</code> classes in R</a></li>
<li class="chapter" data-level="4.3" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html#exercises-2"><i class="fa fa-check"></i><b>4.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html#r-questions-2"><i class="fa fa-check"></i><b>4.3.1</b> R Questions</a></li>
<li class="chapter" data-level="4.3.2" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html#python-questions-2"><i class="fa fa-check"></i><b>4.3.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html"><i class="fa fa-check"></i><b>5</b> R’s <code>list</code>s Versus Python’s <code>list</code>s and <code>dict</code>s</a>
<ul>
<li class="chapter" data-level="5.1" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#lists-in-r"><i class="fa fa-check"></i><b>5.1</b> <code>list</code>s In R</a></li>
<li class="chapter" data-level="5.2" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#lists-in-python"><i class="fa fa-check"></i><b>5.2</b> <code>list</code>s In Python</a></li>
<li class="chapter" data-level="5.3" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#dictionaries-in-python"><i class="fa fa-check"></i><b>5.3</b> Dictionaries In Python</a></li>
<li class="chapter" data-level="5.4" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#exercises-3"><i class="fa fa-check"></i><b>5.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#r-questions-3"><i class="fa fa-check"></i><b>5.4.1</b> R Questions</a></li>
<li class="chapter" data-level="5.4.2" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#python-questions-3"><i class="fa fa-check"></i><b>5.4.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>6</b> Functions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="functions.html"><a href="functions.html#defining-r-functions"><i class="fa fa-check"></i><b>6.1</b> Defining R Functions</a></li>
<li class="chapter" data-level="6.2" data-path="functions.html"><a href="functions.html#defining-python-functions"><i class="fa fa-check"></i><b>6.2</b> Defining Python Functions</a></li>
<li class="chapter" data-level="6.3" data-path="functions.html"><a href="functions.html#more-details-on-rs-user-defined-functions"><i class="fa fa-check"></i><b>6.3</b> More Details On R’s User-Defined Functions</a></li>
<li class="chapter" data-level="6.4" data-path="functions.html"><a href="functions.html#more-details-on-pythons-user-defined-functions"><i class="fa fa-check"></i><b>6.4</b> More details on Python’s user-defined functions</a></li>
<li class="chapter" data-level="6.5" data-path="functions.html"><a href="functions.html#function-scope-in-r"><i class="fa fa-check"></i><b>6.5</b> Function Scope in R</a></li>
<li class="chapter" data-level="6.6" data-path="functions.html"><a href="functions.html#function-scope-in-python"><i class="fa fa-check"></i><b>6.6</b> Function Scope in Python</a></li>
<li class="chapter" data-level="6.7" data-path="functions.html"><a href="functions.html#modifying-a-functions-arguments"><i class="fa fa-check"></i><b>6.7</b> Modifying a Function’s Arguments</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="functions.html"><a href="functions.html#passing-by-value-in-r"><i class="fa fa-check"></i><b>6.7.1</b> Passing By Value In R</a></li>
<li class="chapter" data-level="6.7.2" data-path="functions.html"><a href="functions.html#passing-by-assignment-in-python"><i class="fa fa-check"></i><b>6.7.2</b> Passing By Assignment In Python</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="functions.html"><a href="functions.html#accessing-and-modifying-captured-variables"><i class="fa fa-check"></i><b>6.8</b> Accessing and Modifying Captured Variables</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="functions.html"><a href="functions.html#accessing-captured-variables-in-r"><i class="fa fa-check"></i><b>6.8.1</b> Accessing Captured Variables in R</a></li>
<li class="chapter" data-level="6.8.2" data-path="functions.html"><a href="functions.html#accessing-captured-variables-in-python"><i class="fa fa-check"></i><b>6.8.2</b> Accessing Captured Variables in Python</a></li>
<li class="chapter" data-level="6.8.3" data-path="functions.html"><a href="functions.html#modifying-captured-variables-in-r"><i class="fa fa-check"></i><b>6.8.3</b> Modifying Captured Variables In R</a></li>
<li class="chapter" data-level="6.8.4" data-path="functions.html"><a href="functions.html#modifying-captured-variables-in-python"><i class="fa fa-check"></i><b>6.8.4</b> Modifying Captured Variables In Python</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="functions.html"><a href="functions.html#exercises-4"><i class="fa fa-check"></i><b>6.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="functions.html"><a href="functions.html#r-questions-4"><i class="fa fa-check"></i><b>6.9.1</b> R Questions</a></li>
<li class="chapter" data-level="6.9.2" data-path="functions.html"><a href="functions.html#python-questions-4"><i class="fa fa-check"></i><b>6.9.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="categorical-data.html"><a href="categorical-data.html"><i class="fa fa-check"></i><b>7</b> Categorical Data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="categorical-data.html"><a href="categorical-data.html#factors-in-r"><i class="fa fa-check"></i><b>7.1</b> <code>factor</code>s in R</a></li>
<li class="chapter" data-level="7.2" data-path="categorical-data.html"><a href="categorical-data.html#two-options-for-categorical-data-in-pandas"><i class="fa fa-check"></i><b>7.2</b> Two Options for Categorical Data in Pandas</a></li>
<li class="chapter" data-level="7.3" data-path="categorical-data.html"><a href="categorical-data.html#exercises-5"><i class="fa fa-check"></i><b>7.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="categorical-data.html"><a href="categorical-data.html#r-questions-5"><i class="fa fa-check"></i><b>7.3.1</b> R Questions</a></li>
<li class="chapter" data-level="7.3.2" data-path="categorical-data.html"><a href="categorical-data.html#python-questions-5"><i class="fa fa-check"></i><b>7.3.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>8</b> Data Frames</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-frames.html"><a href="data-frames.html#data-frames-in-r"><i class="fa fa-check"></i><b>8.1</b> Data Frames in R</a></li>
<li class="chapter" data-level="8.2" data-path="data-frames.html"><a href="data-frames.html#data-frames-in-python"><i class="fa fa-check"></i><b>8.2</b> Data Frames in Python</a></li>
<li class="chapter" data-level="8.3" data-path="data-frames.html"><a href="data-frames.html#exercises-6"><i class="fa fa-check"></i><b>8.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="data-frames.html"><a href="data-frames.html#r-questions-6"><i class="fa fa-check"></i><b>8.3.1</b> R Questions</a></li>
<li class="chapter" data-level="8.3.2" data-path="data-frames.html"><a href="data-frames.html#python-questions-6"><i class="fa fa-check"></i><b>8.3.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Common Tasks and Patterns</b></span></li>
<li class="chapter" data-level="9" data-path="input-and-output.html"><a href="input-and-output.html"><i class="fa fa-check"></i><b>9</b> Input and Output</a>
<ul>
<li class="chapter" data-level="9.1" data-path="input-and-output.html"><a href="input-and-output.html#general-input-considerations"><i class="fa fa-check"></i><b>9.1</b> General Input Considerations</a></li>
<li class="chapter" data-level="9.2" data-path="input-and-output.html"><a href="input-and-output.html#reading-in-text-files-with-r"><i class="fa fa-check"></i><b>9.2</b> Reading in Text Files with R</a></li>
<li class="chapter" data-level="9.3" data-path="input-and-output.html"><a href="input-and-output.html#reading-in-text-files-with-pandas"><i class="fa fa-check"></i><b>9.3</b> Reading in Text Files with Pandas</a></li>
<li class="chapter" data-level="9.4" data-path="input-and-output.html"><a href="input-and-output.html#saving-data-in-r"><i class="fa fa-check"></i><b>9.4</b> Saving Data in R</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="input-and-output.html"><a href="input-and-output.html#writing-out-tabular-plain-text-data-in-r"><i class="fa fa-check"></i><b>9.4.1</b> Writing Out Tabular Plain Text Data in R</a></li>
<li class="chapter" data-level="9.4.2" data-path="input-and-output.html"><a href="input-and-output.html#serialization-in-r"><i class="fa fa-check"></i><b>9.4.2</b> Serialization in R</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="input-and-output.html"><a href="input-and-output.html#saving-data-in-python"><i class="fa fa-check"></i><b>9.5</b> Saving Data in Python</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="input-and-output.html"><a href="input-and-output.html#writing-out-tabular-plain-text-data-in-python"><i class="fa fa-check"></i><b>9.5.1</b> Writing Out Tabular Plain Text Data in Python</a></li>
<li class="chapter" data-level="9.5.2" data-path="input-and-output.html"><a href="input-and-output.html#serialization-in-python"><i class="fa fa-check"></i><b>9.5.2</b> Serialization in Python</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="input-and-output.html"><a href="input-and-output.html#exercises-7"><i class="fa fa-check"></i><b>9.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="input-and-output.html"><a href="input-and-output.html#r-questions-7"><i class="fa fa-check"></i><b>9.6.1</b> R Questions</a></li>
<li class="chapter" data-level="9.6.2" data-path="input-and-output.html"><a href="input-and-output.html#python-questions-7"><i class="fa fa-check"></i><b>9.6.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="using-third-party-code.html"><a href="using-third-party-code.html"><i class="fa fa-check"></i><b>10</b> Using Third-Party Code</a>
<ul>
<li class="chapter" data-level="10.1" data-path="using-third-party-code.html"><a href="using-third-party-code.html#installing-packages-in-r"><i class="fa fa-check"></i><b>10.1</b> Installing Packages In R</a></li>
<li class="chapter" data-level="10.2" data-path="using-third-party-code.html"><a href="using-third-party-code.html#installing-packages-in-python"><i class="fa fa-check"></i><b>10.2</b> Installing Packages In Python</a></li>
<li class="chapter" data-level="10.3" data-path="using-third-party-code.html"><a href="using-third-party-code.html#loading-packages-in-r"><i class="fa fa-check"></i><b>10.3</b> Loading Packages In R</a></li>
<li class="chapter" data-level="10.4" data-path="using-third-party-code.html"><a href="using-third-party-code.html#loading-packages-in-python"><i class="fa fa-check"></i><b>10.4</b> Loading Packages In Python</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="using-third-party-code.html"><a href="using-third-party-code.html#importing-examples"><i class="fa fa-check"></i><b>10.4.1</b> <code>import</code>ing Examples</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="using-third-party-code.html"><a href="using-third-party-code.html#exercises-8"><i class="fa fa-check"></i><b>10.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="control-flow.html"><a href="control-flow.html"><i class="fa fa-check"></i><b>11</b> Control Flow</a>
<ul>
<li class="chapter" data-level="11.1" data-path="control-flow.html"><a href="control-flow.html#conditional-logic"><i class="fa fa-check"></i><b>11.1</b> Conditional Logic</a></li>
<li class="chapter" data-level="11.2" data-path="control-flow.html"><a href="control-flow.html#loops"><i class="fa fa-check"></i><b>11.2</b> Loops</a></li>
<li class="chapter" data-level="11.3" data-path="control-flow.html"><a href="control-flow.html#exercises-9"><i class="fa fa-check"></i><b>11.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="control-flow.html"><a href="control-flow.html#r-questions-8"><i class="fa fa-check"></i><b>11.3.1</b> R Questions</a></li>
<li class="chapter" data-level="11.3.2" data-path="control-flow.html"><a href="control-flow.html#python-questions-8"><i class="fa fa-check"></i><b>11.3.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html"><i class="fa fa-check"></i><b>12</b> Reshaping and Combining Data Sets</a>
<ul>
<li class="chapter" data-level="12.1" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#ordering-and-sorting-data"><i class="fa fa-check"></i><b>12.1</b> Ordering and Sorting Data</a></li>
<li class="chapter" data-level="12.2" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#stacking-data-sets-and-placing-them-shoulder-to-shoulder"><i class="fa fa-check"></i><b>12.2</b> Stacking Data Sets and Placing Them Shoulder to Shoulder</a></li>
<li class="chapter" data-level="12.3" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#merging-or-joining-data-sets"><i class="fa fa-check"></i><b>12.3</b> Merging or Joining Data Sets</a></li>
<li class="chapter" data-level="12.4" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#long-versus-wide-data"><i class="fa fa-check"></i><b>12.4</b> Long Versus Wide Data</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#long-versus-wide-in-r"><i class="fa fa-check"></i><b>12.4.1</b> Long Versus Wide in R</a></li>
<li class="chapter" data-level="12.4.2" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#long-versus-wide-in-python"><i class="fa fa-check"></i><b>12.4.2</b> Long Versus Wide in Python</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#exercises-10"><i class="fa fa-check"></i><b>12.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#r-questions-9"><i class="fa fa-check"></i><b>12.5.1</b> R Questions</a></li>
<li class="chapter" data-level="12.5.2" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#python-questions-9"><i class="fa fa-check"></i><b>12.5.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>13</b> Visualization</a>
<ul>
<li class="chapter" data-level="13.1" data-path="visualization.html"><a href="visualization.html#base-r-plotting"><i class="fa fa-check"></i><b>13.1</b> Base R Plotting</a></li>
<li class="chapter" data-level="13.2" data-path="visualization.html"><a href="visualization.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>13.2</b> Plotting with <code>ggplot2</code></a></li>
<li class="chapter" data-level="13.3" data-path="visualization.html"><a href="visualization.html#plotting-with-matplotlib"><i class="fa fa-check"></i><b>13.3</b> Plotting with Matplotlib</a></li>
<li class="chapter" data-level="13.4" data-path="visualization.html"><a href="visualization.html#plotting-with-pandas"><i class="fa fa-check"></i><b>13.4</b> Plotting with Pandas</a></li>
<li class="chapter" data-level="13.5" data-path="visualization.html"><a href="visualization.html#exercises-11"><i class="fa fa-check"></i><b>13.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="visualization.html"><a href="visualization.html#r-questions-10"><i class="fa fa-check"></i><b>13.5.1</b> R Questions</a></li>
<li class="chapter" data-level="13.5.2" data-path="visualization.html"><a href="visualization.html#python-questions-10"><i class="fa fa-check"></i><b>13.5.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Programming Styles</b></span></li>
<li class="chapter" data-level="14" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html"><i class="fa fa-check"></i><b>14</b> An Introduction to Object-Oriented Programming</a>
<ul>
<li class="chapter" data-level="14.1" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#oop-in-python"><i class="fa fa-check"></i><b>14.1</b> OOP In Python</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#overview"><i class="fa fa-check"></i><b>14.1.1</b> Overview</a></li>
<li class="chapter" data-level="14.1.2" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#a-first-example"><i class="fa fa-check"></i><b>14.1.2</b> A First Example</a></li>
<li class="chapter" data-level="14.1.3" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#adding-inheritance"><i class="fa fa-check"></i><b>14.1.3</b> Adding Inheritance</a></li>
<li class="chapter" data-level="14.1.4" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#adding-in-composition"><i class="fa fa-check"></i><b>14.1.4</b> Adding in Composition</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#oop-in-r"><i class="fa fa-check"></i><b>14.2</b> OOP In R</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#s3-objects-the-big-picture"><i class="fa fa-check"></i><b>14.2.1</b> S3 objects: The Big Picture</a></li>
<li class="chapter" data-level="14.2.2" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#using-s3-objects"><i class="fa fa-check"></i><b>14.2.2</b> Using S3 objects</a></li>
<li class="chapter" data-level="14.2.3" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#creating-s3-objects"><i class="fa fa-check"></i><b>14.2.3</b> Creating S3 objects</a></li>
<li class="chapter" data-level="14.2.4" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#s4-objects-the-big-picture"><i class="fa fa-check"></i><b>14.2.4</b> S4 objects: The Big Picture</a></li>
<li class="chapter" data-level="14.2.5" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#using-s4-objects"><i class="fa fa-check"></i><b>14.2.5</b> Using S4 objects</a></li>
<li class="chapter" data-level="14.2.6" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#creating-s4-objects"><i class="fa fa-check"></i><b>14.2.6</b> Creating S4 objects</a></li>
<li class="chapter" data-level="14.2.7" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#reference-classes-the-big-picture"><i class="fa fa-check"></i><b>14.2.7</b> Reference Classes: The Big Picture</a></li>
<li class="chapter" data-level="14.2.8" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#creating-reference-classes"><i class="fa fa-check"></i><b>14.2.8</b> Creating Reference Classes</a></li>
<li class="chapter" data-level="14.2.9" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#creating-r6-classes"><i class="fa fa-check"></i><b>14.2.9</b> Creating R6 Classes</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#exercises-12"><i class="fa fa-check"></i><b>14.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#python-questions-11"><i class="fa fa-check"></i><b>14.3.1</b> Python Questions</a></li>
<li class="chapter" data-level="14.3.2" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#r-questions-11"><i class="fa fa-check"></i><b>14.3.2</b> R Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html"><i class="fa fa-check"></i><b>15</b> An Introduction to Functional Programming</a>
<ul>
<li class="chapter" data-level="15.1" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#functions-as-function-inputs-in-r"><i class="fa fa-check"></i><b>15.1</b> Functions as Function Inputs in R</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#sapply-and-vapply"><i class="fa fa-check"></i><b>15.1.1</b> <code>sapply()</code> and <code>vapply()</code></a></li>
<li class="chapter" data-level="15.1.2" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#lapply"><i class="fa fa-check"></i><b>15.1.2</b> <code>lapply()</code></a></li>
<li class="chapter" data-level="15.1.3" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#apply"><i class="fa fa-check"></i><b>15.1.3</b> <code>apply()</code></a></li>
<li class="chapter" data-level="15.1.4" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#tapply"><i class="fa fa-check"></i><b>15.1.4</b> <code>tapply()</code></a></li>
<li class="chapter" data-level="15.1.5" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#mapply"><i class="fa fa-check"></i><b>15.1.5</b> <code>mapply()</code></a></li>
<li class="chapter" data-level="15.1.6" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#reduce-and-do.call"><i class="fa fa-check"></i><b>15.1.6</b> <code>Reduce()</code> and <code>do.call()</code></a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#functions-as-function-inputs-in-python"><i class="fa fa-check"></i><b>15.2</b> Functions as Function Inputs in Python</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#functions-as-function-inputs-in-base-python"><i class="fa fa-check"></i><b>15.2.1</b> Functions as Function Inputs in Base Python</a></li>
<li class="chapter" data-level="15.2.2" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#functions-as-function-inputs-in-numpy"><i class="fa fa-check"></i><b>15.2.2</b> Functions as Function Inputs in Numpy</a></li>
<li class="chapter" data-level="15.2.3" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#functional-methods-in-pandas"><i class="fa fa-check"></i><b>15.2.3</b> Functional Methods in Pandas</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#functions-as-function-outputs-in-r"><i class="fa fa-check"></i><b>15.3</b> Functions as Function Outputs in R</a></li>
<li class="chapter" data-level="15.4" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#functions-as-function-outputs-in-python"><i class="fa fa-check"></i><b>15.4</b> Functions as Function Outputs in Python</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#writing-our-own-decorators"><i class="fa fa-check"></i><b>15.4.1</b> Writing Our Own Decorators</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#exercises-13"><i class="fa fa-check"></i><b>15.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#python-questions-12"><i class="fa fa-check"></i><b>15.5.1</b> Python Questions</a></li>
<li class="chapter" data-level="15.5.2" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#r-questions-12"><i class="fa fa-check"></i><b>15.5.2</b> R Questions</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to R and Python For Data Analysis: A Side By Side Approach</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="an-introduction-to-object-oriented-programming" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Chapter 14</span> An Introduction to Object-Oriented Programming<a href="an-introduction-to-object-oriented-programming.html#an-introduction-to-object-oriented-programming" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Object-Oriented Programming (OOP)</strong> is a way of thinking about how to organize programs. This way of thinking focuses on objects. In the next chapter, we focus on organizing programs by functions, but for now we stick to objects. We already know about objects from the last chapter, so what’s new here?</p>
<p>The difference is that we’re creating our own <em>types</em> now. In the last chapter we learned about built-in types: floating point numbers, lists, arrays, functions, etc. Now we will discuss broadly how one can create his own types in both R and Python. These user-defined types can be used as cookie cutters. Once we have the cookie cutter, we can make as many cookies as we want!</p>
<p>We will not go into this too deeply, but it is important to know how how code works so that we can use it more effectively. For instance, in Python, we frequently write code like <code>my_data_frame.doSomething()</code>. The material in this chapter will go a long way to describe how we can make our own types with custom behavior.</p>
<hr />
<p>Here are a few abstract concepts that will help thinking about OOP. They are not mutually exclusive, and they aren’t unique to OOP, but understanding these words will help you understand the purpose of OOP. Later on, when we start looking at code examples, I will alert you to when these concepts are coming into play.</p>
<ul>
<li><p><strong>Composition</strong> refers to the idea when one type of object <em>contains</em> an object of another type. For example, a linear model object could hold onto estimated regression coefficients, residuals, etc.</p></li>
<li><p><strong>Inheritance</strong> takes place when an object can be considered to be of another type(s). For example, an analysis of variance linear regression model might be a special case of a general linear model.</p></li>
<li><p><strong>Polymorphism</strong> is the idea that the programmer can use the same code on objects of different types. For example, built-in functions in both R and Python can work on arguments of a wide variety of different types.</p></li>
<li><p><strong>Encapsulation</strong> is another word for complexity hiding. Do you have to understand every line of code in a package you’re using? No, because a lot of details are purposefully hidden from you.</p></li>
<li><p><strong>Modularity</strong> is an idea related to encapsulation–it means splitting something into independent pieces. How you split code into different files, different functions, different classes–all of that has to do with modularity. It promotes encapsulation, and it allows you to think about only a few lines of code at a time.</p></li>
<li><p>The <strong>interface</strong>, between you and the code you’re using, describes <em>what</em> can happen, but not <em>how</em> it happens. In other words, it describes some functionality so that you can decide whether you want to use it, but there are not enough details for you to make it work yourself. For example, all you have to do to be able to estimate a complicated statistical model is to look up some documentation.<a href="#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a> In other words, you only need to be familiar with the interface, not the implementation.</p></li>
<li><p>The <strong>implementation</strong> of some code you’re using describes <em>how</em> it works in detail. If you are a package author, you can change your code’s implementation “behind the scenes” and ideally, your end-users would never notice.</p></li>
</ul>
<div id="oop-in-python" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> OOP In Python<a href="an-introduction-to-object-oriented-programming.html#oop-in-python" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="overview" class="section level3 hasAnchor" number="14.1.1">
<h3><span class="header-section-number">14.1.1</span> Overview<a href="an-introduction-to-object-oriented-programming.html#overview" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Python, <a href="https://docs.python.org/3/tutorial/classes.html">classes</a> are user-defined types. When you define your own class, you describe what kind of information it holds onto, and how it behaves.</p>
<p>To define your own type, use the <a href="https://docs.python.org/3/tutorial/classes.html#class-definition-syntax"><code>class</code> keyword</a>. Objects created with a user-defined class are sometimes called <strong>instances</strong>. They behave according to the rules written in the class definition–they always have data and/or functions bundled together in the same way, but these instances do not all have the same data.</p>
<p>To be more clear, classes may have the following two things in their definition.</p>
<ul>
<li><p><strong>Attributes (aka data members)</strong> are pieces of data “owned” by an instance created by the class.</p></li>
<li><p><strong>(Instance) methods</strong> are functions “owned” by an instance created by the class. They can use and/or modify data belonging to the class.</p></li>
</ul>
</div>
<div id="a-first-example" class="section level3 hasAnchor" number="14.1.2">
<h3><span class="header-section-number">14.1.2</span> A First Example<a href="an-introduction-to-object-oriented-programming.html#a-first-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here’s a simple example. Say we are interested in calculating, from numerical data <span class="math inline">\(x_1, \ldots, x_n\)</span>, a sample mean:
<span class="math display">\[\begin{equation}
\bar{x}_n = \frac{\sum_{i=1}^n x_i}{n}.
\end{equation}\]</span></p>
<p>In Python, we can usually calculate this one number very easily using <code>np.average</code>. However, this function requires that we pass into it all of the data at once. What if we don’t have all the data at any given time? In other words, suppose that the data arrive intermittently
.
We might consider taking advantage of a recursive formula for the sample means.</p>
<p><span class="math display">\[\begin{equation}
\bar{x}_n =  \frac{(n-1) \bar{x}_{n-1} + x_n}{n}
\end{equation}\]</span></p>
<p>How would we program this in Python? A first option: we might create a variable <code>my_running_ave</code>, and after every data point arrives, we could</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb234-1"><a href="an-introduction-to-object-oriented-programming.html#cb234-1" aria-hidden="true" tabindex="-1"></a>my_running_ave <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb234-2"><a href="an-introduction-to-object-oriented-programming.html#cb234-2" aria-hidden="true" tabindex="-1"></a>my_running_ave</span>
<span id="cb234-3"><a href="an-introduction-to-object-oriented-programming.html#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="co">## 1.0</span></span>
<span id="cb234-4"><a href="an-introduction-to-object-oriented-programming.html#cb234-4" aria-hidden="true" tabindex="-1"></a>my_running_ave <span class="op">=</span> ((<span class="dv">2</span><span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>my_running_ave <span class="op">+</span> <span class="fl">3.0</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb234-5"><a href="an-introduction-to-object-oriented-programming.html#cb234-5" aria-hidden="true" tabindex="-1"></a>my_running_ave</span>
<span id="cb234-6"><a href="an-introduction-to-object-oriented-programming.html#cb234-6" aria-hidden="true" tabindex="-1"></a><span class="co">## 2.0</span></span>
<span id="cb234-7"><a href="an-introduction-to-object-oriented-programming.html#cb234-7" aria-hidden="true" tabindex="-1"></a>my_running_ave <span class="op">=</span> ((<span class="dv">3</span><span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>my_running_ave <span class="op">+</span> <span class="fl">2.0</span>)<span class="op">/</span><span class="dv">3</span></span>
<span id="cb234-8"><a href="an-introduction-to-object-oriented-programming.html#cb234-8" aria-hidden="true" tabindex="-1"></a>my_running_ave</span>
<span id="cb234-9"><a href="an-introduction-to-object-oriented-programming.html#cb234-9" aria-hidden="true" tabindex="-1"></a><span class="co">## 2.0</span></span></code></pre></div>
<p>There are a few problems with this. Every time we add a data point, the formula slightly changes. Every time we update the average, we have to write a different line of code. This opens up the possibility for more bugs, and it makes your code less likely to be used by other people and more difficult to understand. And if we were trying to code up something more complicated than a running average? That would make matters even worse.</p>
<p>A second option: write a class that holds onto the running average, and that has</p>
<ol style="list-style-type: decimal">
<li>an <code>update</code> method that updates the running average every time a new data point is received, and</li>
<li>a <code>get_current_xbar</code> method that gets the most up-to-date information for us.</li>
</ol>
<p>Using our code would look like this:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb235-1"><a href="an-introduction-to-object-oriented-programming.html#cb235-1" aria-hidden="true" tabindex="-1"></a>my_ave <span class="op">=</span> RunningMean() <span class="co"># create running average object</span></span>
<span id="cb235-2"><a href="an-introduction-to-object-oriented-programming.html#cb235-2" aria-hidden="true" tabindex="-1"></a>my_ave.get_current_xbar() <span class="co"># no data yet!</span></span>
<span id="cb235-3"><a href="an-introduction-to-object-oriented-programming.html#cb235-3" aria-hidden="true" tabindex="-1"></a>my_ave.update(<span class="fl">1.</span>) <span class="co"># first data point</span></span>
<span id="cb235-4"><a href="an-introduction-to-object-oriented-programming.html#cb235-4" aria-hidden="true" tabindex="-1"></a>my_ave.get_current_xbar() <span class="co"># xbar_1</span></span>
<span id="cb235-5"><a href="an-introduction-to-object-oriented-programming.html#cb235-5" aria-hidden="true" tabindex="-1"></a><span class="co">## 1.0</span></span>
<span id="cb235-6"><a href="an-introduction-to-object-oriented-programming.html#cb235-6" aria-hidden="true" tabindex="-1"></a>my_ave.update(<span class="fl">3.</span>)  <span class="co"># second data point</span></span>
<span id="cb235-7"><a href="an-introduction-to-object-oriented-programming.html#cb235-7" aria-hidden="true" tabindex="-1"></a>my_ave.get_current_xbar()  <span class="co">#xbar_2</span></span>
<span id="cb235-8"><a href="an-introduction-to-object-oriented-programming.html#cb235-8" aria-hidden="true" tabindex="-1"></a><span class="co">## 2.0</span></span>
<span id="cb235-9"><a href="an-introduction-to-object-oriented-programming.html#cb235-9" aria-hidden="true" tabindex="-1"></a>my_ave.n   <span class="co"># my_ave.n instead of self.n</span></span>
<span id="cb235-10"><a href="an-introduction-to-object-oriented-programming.html#cb235-10" aria-hidden="true" tabindex="-1"></a><span class="co">## 2</span></span></code></pre></div>
<div class="rmd-details">
<p>There is a Python convention that stipules class names should be written in <code>UpperCamelCase</code> (e.g. <code>RunningMean</code>).</p>
</div>
<p>That’s much better! Notice the <em>encapsulation</em>–while looking at this code we do not need to think about the mathematical formula that is used to process the data. We only need to type in the correct data being used. In other words, the <em>implementation</em> is separated from the <em>interface</em>. The interface in this case, is just the name of the class methods, and the arguments they expect. That’s all we need to know about to use this code.</p>
<div class="rmd-caution">
<p>After seeing these new words that are unfamiliar and long, it’s tempting to dismiss these new ideas as superfluous. After all, if you are confident that you can get your program working, why stress about all these new concepts? If it ain’t broke, don’t fix it, right?</p>
<p>I urge you to try to keep an open mind, particularly if you are already confident that you understand the basics of programming in R and Python. The topics in this chapter are more centered around design choices. This material won’t help you write a first draft of a script even faster, but it will make your code much better. Even though you will have to slow down a bit before you start typing, thinking about your program more deeply will prevent bugs and allow more people to use your code.</p>
</div>
<p>Classes (obviously) need to be defined before they are used, so here is the definition of our class.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb236-1"><a href="an-introduction-to-object-oriented-programming.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> RunningMean:</span>
<span id="cb236-2"><a href="an-introduction-to-object-oriented-programming.html#cb236-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Updates a running average&quot;&quot;&quot;</span></span>
<span id="cb236-3"><a href="an-introduction-to-object-oriented-programming.html#cb236-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb236-4"><a href="an-introduction-to-object-oriented-programming.html#cb236-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.current_xbar <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb236-5"><a href="an-introduction-to-object-oriented-programming.html#cb236-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.n <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb236-6"><a href="an-introduction-to-object-oriented-programming.html#cb236-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> update(<span class="va">self</span>, new_x):</span>
<span id="cb236-7"><a href="an-introduction-to-object-oriented-programming.html#cb236-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.n <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb236-8"><a href="an-introduction-to-object-oriented-programming.html#cb236-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.current_xbar <span class="op">*=</span> (<span class="va">self</span>.n<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb236-9"><a href="an-introduction-to-object-oriented-programming.html#cb236-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.current_xbar <span class="op">+=</span> new_x</span>
<span id="cb236-10"><a href="an-introduction-to-object-oriented-programming.html#cb236-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.current_xbar <span class="op">/=</span> <span class="va">self</span>.n</span>
<span id="cb236-11"><a href="an-introduction-to-object-oriented-programming.html#cb236-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_current_xbar(<span class="va">self</span>):</span>
<span id="cb236-12"><a href="an-introduction-to-object-oriented-programming.html#cb236-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.n <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb236-13"><a href="an-introduction-to-object-oriented-programming.html#cb236-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb236-14"><a href="an-introduction-to-object-oriented-programming.html#cb236-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb236-15"><a href="an-introduction-to-object-oriented-programming.html#cb236-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.current_xbar</span></code></pre></div>
<div class="rmd-details">
<p>Methods that look like <code>__init__</code>, or that possess names that begin and end with two underscores, are called <strong>dunder (double underscore) methods</strong>, <strong>special methods</strong> or <strong>magic methods</strong>. There are many that you can take advantage of! For more information see <a href="https://docs.python.org/3/reference/datamodel.html#special-method-names">this</a>.</p>
</div>
<p>Here are the details of the class definition:</p>
<ol style="list-style-type: decimal">
<li><p>Defining class methods looks exactly like defining functions! The primary difference is that the first argument must be <code>self</code>. If the definition of a method refers to <code>self</code>, then this allows the class instance to refer to its own (heretofore undefined) data attributes. Also, these method definitions are indented inside the definition of the class.</p></li>
<li><p>This class owns two data attributes. One to represent the number of data points seen up to now (<code>n</code>), and another to represent the current running average (<code>current_xbar</code>).</p></li>
<li><p>Referring to data members requires dot notation. <code>self.n</code> refers to the <code>n</code> belonging to any instance. This data attribute is free to vary between all the objects instantiated by this class.</p></li>
<li><p>The <code>__init__</code> method performs the setup operations that are performed every time any object is instantiated.</p></li>
<li><p>The <code>update</code> method provides the core functionality using the recursive formula displayed above.</p></li>
<li><p><code>get_current_xbar</code> simply returns the current average. In the case that this function is called before any data has been seen, it returns <code>None</code>.</p></li>
</ol>
<p>A few things you might find interesting:</p>
<ol style="list-style-type: lower-roman">
<li><p>Computationally, there is never any requirement that we must hold <em>all</em> of the data points in memory. Our data set could be infinitely large, and our class will hold onto only one floating point number, and one integer.</p></li>
<li><p>This example is generalizable to other statistical methods. In a mathematical statistics course, you will learn about a large class of models having <em>sufficient statistics</em>. Most sufficient statistics have recursive formulas like the one above. Second, many algorithms in <em>time series analysis</em> have recursive formulas and are often needed to analyze large streams of data. They can all be wrapped into a class in a way that is similar to the above example.</p></li>
</ol>
</div>
<div id="adding-inheritance" class="section level3 hasAnchor" number="14.1.3">
<h3><span class="header-section-number">14.1.3</span> Adding Inheritance<a href="an-introduction-to-object-oriented-programming.html#adding-inheritance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>How can we use inheritance in statistical programming? A primary benefit of inheritance is code re-use, so one example of inheritance is writing a generic algorithm as a base class, and a specific algorithm as a class that inherits from the base class. For example, we could re-use the code in the <code>RunningMean</code> class in a variety of other classes.</p>
<p>Let’s make some assumptions about a <em>parametric model</em> that is generating our data. Suppose I assume that the data points <span class="math inline">\(x_1, \ldots, x_n\)</span> are a “random sample”<a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a> from a normal distribution with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2=1\)</span>. <span class="math inline">\(\mu\)</span> is assumed to be unknown (this is, after all, and interval for <span class="math inline">\(\mu\)</span>), and <span class="math inline">\(\sigma^2\)</span> is assumed to be known, for simplicity.</p>
<p>A <span class="math inline">\(95\%\)</span> confidence interval for the true unknown population mean <span class="math inline">\(\mu\)</span> is</p>
<p><span class="math display">\[\begin{equation}
\left( \bar{x} - 1.96 \sqrt{\frac{\sigma^2}{n}}, \bar{x} + 1.96 \sqrt{\frac{\sigma^2}{n}} \right).
\end{equation}\]</span></p>
<p>The width of the interval shrinks as we get more data (as <span class="math inline">\(n \to \infty\)</span>). We can write another class that, not only calculates the center of this interval, <span class="math inline">\(\bar{x}\)</span>, but also returns the interval endpoints.</p>
<p>If we wrote another class from scratch, then we would need to rewrite a lot of the code that we already have in the definition of <code>RunningMean</code>. Instead, we’ll use the idea of <a href="https://docs.python.org/3/tutorial/classes.html#inheritance"><em>inheritance</em></a>.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb237-1"><a href="an-introduction-to-object-oriented-programming.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb237-2"><a href="an-introduction-to-object-oriented-programming.html#cb237-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3"><a href="an-introduction-to-object-oriented-programming.html#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> RunningCI(RunningMean):<span class="co"># &lt;-notice what&#39;s inside the parentheses</span></span>
<span id="cb237-4"><a href="an-introduction-to-object-oriented-programming.html#cb237-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Updates a running average and </span></span>
<span id="cb237-5"><a href="an-introduction-to-object-oriented-programming.html#cb237-5" aria-hidden="true" tabindex="-1"></a><span class="co">    gives you a known-variance confidence interval&quot;&quot;&quot;</span></span>
<span id="cb237-6"><a href="an-introduction-to-object-oriented-programming.html#cb237-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-7"><a href="an-introduction-to-object-oriented-programming.html#cb237-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, known_var):</span>
<span id="cb237-8"><a href="an-introduction-to-object-oriented-programming.html#cb237-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb237-9"><a href="an-introduction-to-object-oriented-programming.html#cb237-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.known_var <span class="op">=</span> known_var</span>
<span id="cb237-10"><a href="an-introduction-to-object-oriented-programming.html#cb237-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-11"><a href="an-introduction-to-object-oriented-programming.html#cb237-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_current_interval(<span class="va">self</span>):</span>
<span id="cb237-12"><a href="an-introduction-to-object-oriented-programming.html#cb237-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.n <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb237-13"><a href="an-introduction-to-object-oriented-programming.html#cb237-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb237-14"><a href="an-introduction-to-object-oriented-programming.html#cb237-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb237-15"><a href="an-introduction-to-object-oriented-programming.html#cb237-15" aria-hidden="true" tabindex="-1"></a>            half_width <span class="op">=</span> <span class="fl">1.96</span> <span class="op">*</span> np.sqrt(<span class="va">self</span>.known_var <span class="op">/</span> <span class="va">self</span>.n)  </span>
<span id="cb237-16"><a href="an-introduction-to-object-oriented-programming.html#cb237-16" aria-hidden="true" tabindex="-1"></a>            left_num <span class="op">=</span> <span class="va">self</span>.current_xbar <span class="op">-</span> half_width</span>
<span id="cb237-17"><a href="an-introduction-to-object-oriented-programming.html#cb237-17" aria-hidden="true" tabindex="-1"></a>            right_num <span class="op">=</span> <span class="va">self</span>.current_xbar <span class="op">+</span> half_width</span>
<span id="cb237-18"><a href="an-introduction-to-object-oriented-programming.html#cb237-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> np.array([left_num, right_num])</span></code></pre></div>
<p>The parentheses in the first line of the class definition signal that this new class definition is inheriting from <code>RunningMean</code>. Inside the definition of this new class, when I refer to <code>self.current_xbar</code> Python knows what I’m referring to because it is defined in the base class. Last, I am using <code>super()</code> to access the base class’s methods, such as <code>__init__</code>.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb238-1"><a href="an-introduction-to-object-oriented-programming.html#cb238-1" aria-hidden="true" tabindex="-1"></a>my_ci <span class="op">=</span> RunningCI(<span class="dv">1</span>) <span class="co"># create running average object</span></span>
<span id="cb238-2"><a href="an-introduction-to-object-oriented-programming.html#cb238-2" aria-hidden="true" tabindex="-1"></a>my_ci.get_current_xbar() <span class="co"># no data yet!</span></span>
<span id="cb238-3"><a href="an-introduction-to-object-oriented-programming.html#cb238-3" aria-hidden="true" tabindex="-1"></a>my_ci.update(<span class="fl">1.</span>) </span>
<span id="cb238-4"><a href="an-introduction-to-object-oriented-programming.html#cb238-4" aria-hidden="true" tabindex="-1"></a>my_ci.get_current_interval() </span>
<span id="cb238-5"><a href="an-introduction-to-object-oriented-programming.html#cb238-5" aria-hidden="true" tabindex="-1"></a><span class="co">## array([-0.96,  2.96])</span></span>
<span id="cb238-6"><a href="an-introduction-to-object-oriented-programming.html#cb238-6" aria-hidden="true" tabindex="-1"></a>my_ci.update(<span class="fl">3.</span>)  </span>
<span id="cb238-7"><a href="an-introduction-to-object-oriented-programming.html#cb238-7" aria-hidden="true" tabindex="-1"></a>my_ci.get_current_interval()  </span>
<span id="cb238-8"><a href="an-introduction-to-object-oriented-programming.html#cb238-8" aria-hidden="true" tabindex="-1"></a><span class="co">## array([0.61407071, 3.38592929])</span></span></code></pre></div>
<p>This example also demonstrates <strong>polymorphism.</strong> Polymorphism comes from the Greek for “many forms.” “Forms” means “type” or “class” in this case. If the same code (usually a function or method) works on objects of different types, that’s polymorphic. Here, the <code>update</code> method worked on an object of class <code>RunningCI</code>, as well as an object of <code>RunningMean</code>.</p>
<p>Why is this useful? Consider this example.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb239-1"><a href="an-introduction-to-object-oriented-programming.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> datum <span class="kw">in</span> time_series:</span>
<span id="cb239-2"><a href="an-introduction-to-object-oriented-programming.html#cb239-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> thing <span class="kw">in</span> obj_list:</span>
<span id="cb239-3"><a href="an-introduction-to-object-oriented-programming.html#cb239-3" aria-hidden="true" tabindex="-1"></a>        thing.update(xt)</span></code></pre></div>
<p>Inside the inner <code>for</code> loop, there is no need for include conditional logic that tests for what kind of type each <code>thing</code> is. We can iterate through time more succinctly.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb240-1"><a href="an-introduction-to-object-oriented-programming.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> datum <span class="kw">in</span> time_series:</span>
<span id="cb240-2"><a href="an-introduction-to-object-oriented-programming.html#cb240-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> thing <span class="kw">in</span> obj_list:</span>
<span id="cb240-3"><a href="an-introduction-to-object-oriented-programming.html#cb240-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(thing, class1):</span>
<span id="cb240-4"><a href="an-introduction-to-object-oriented-programming.html#cb240-4" aria-hidden="true" tabindex="-1"></a>            thing.updatec1(xt)</span>
<span id="cb240-5"><a href="an-introduction-to-object-oriented-programming.html#cb240-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(thing, class2):</span>
<span id="cb240-6"><a href="an-introduction-to-object-oriented-programming.html#cb240-6" aria-hidden="true" tabindex="-1"></a>            thing.updatec2(xt)</span>
<span id="cb240-7"><a href="an-introduction-to-object-oriented-programming.html#cb240-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(thing, class3):</span>
<span id="cb240-8"><a href="an-introduction-to-object-oriented-programming.html#cb240-8" aria-hidden="true" tabindex="-1"></a>            thing.updatec3(xt)</span>
<span id="cb240-9"><a href="an-introduction-to-object-oriented-programming.html#cb240-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(thing, class4):</span>
<span id="cb240-10"><a href="an-introduction-to-object-oriented-programming.html#cb240-10" aria-hidden="true" tabindex="-1"></a>            thing.updatec4(xt)</span>
<span id="cb240-11"><a href="an-introduction-to-object-oriented-programming.html#cb240-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(thing, class5):</span>
<span id="cb240-12"><a href="an-introduction-to-object-oriented-programming.html#cb240-12" aria-hidden="true" tabindex="-1"></a>            thing.updatec5(xt)</span>
<span id="cb240-13"><a href="an-introduction-to-object-oriented-programming.html#cb240-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(thing, class6):</span>
<span id="cb240-14"><a href="an-introduction-to-object-oriented-programming.html#cb240-14" aria-hidden="true" tabindex="-1"></a>            thing.updatec6(xt)</span></code></pre></div>
<p>If, in the future, you add a new class called <code>class7</code>, then you need to change this inner <code>for</code> loop, as well as provide new code for the class.</p>
</div>
<div id="adding-in-composition" class="section level3 hasAnchor" number="14.1.4">
<h3><span class="header-section-number">14.1.4</span> Adding in Composition<a href="an-introduction-to-object-oriented-programming.html#adding-in-composition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>Composition</em> also enables code re-use. Inheritance ensures an “is a” relationship between base and derived classes, and composition promotes a “has a” relationship. Sometimes it can be tricky to decide which technique to use, especially when it comes to statistical programming.</p>
<p>Regarding the example above, you might argue that a confidence interval isn’t a particular type of a sample mean. Rather, it only <em>has a</em> sample mean. If you believe this, then you might opt for a composition based model instead. With composition, the derived class (the confidence interval class) will be decoupled from the base class (the sample mean class). This decoupling will have a few implications. In general, composition is more flexible, but can lead to longer, uglier code.</p>
<ol style="list-style-type: decimal">
<li><p>You will lose polymorphism.</p></li>
<li><p>Your code might become less re-usable.</p>
<ul>
<li><p>You have to write any derive class methods you want because you don’t inherit any from the base class. For example, you won’t automatically get the <code>.update()</code> or the <code>.get_current_xbar()</code> method for free. This can be tedious if there are a lot of methods you want both classes to have that should work the same exact way for both classes. If there are, you would have to re-write a bunch of method definitions.</p></li>
<li><p>On the other hand, this could be good if you have methods that behave completely differently. Each method you write can have totally different behavior in the derived class, even if the method names are the same in both classes. For instance, <code>.update()</code> could mean something totally different in these two classes. Also, in the derive class, you can still call the base class’s <code>.update()</code> method.</p></li>
</ul></li>
<li><p>Many-to-one relationships are easier. It’s generally easier to “own” many base class instances rather than inherit from many base classes at once. This is especially true if this is the only book on programming you plan on reading–I completely avoid the topic of multiple inheritance!</p></li>
</ol>
<div class="rmd-caution">
<p>Sometimes it is very difficult to choose between using composition or using inheritance. However, this choice should be made very carefully. If you make the wrong one, and realize too late, <em>refactoring</em> your code might be very time consuming!</p>
</div>
<p>Here is an example implementation of a confidence interval using composition. Notice that this class “owns” a <code>RunningMean</code> instance called <code>self.mean</code>. This is contrast with <em>inheriting</em> from the <code>RunningMean</code> class.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb241-1"><a href="an-introduction-to-object-oriented-programming.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> RunningCI2:</span>
<span id="cb241-2"><a href="an-introduction-to-object-oriented-programming.html#cb241-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Updates a running average and </span></span>
<span id="cb241-3"><a href="an-introduction-to-object-oriented-programming.html#cb241-3" aria-hidden="true" tabindex="-1"></a><span class="co">    gives you a known-variance confidence interval&quot;&quot;&quot;</span></span>
<span id="cb241-4"><a href="an-introduction-to-object-oriented-programming.html#cb241-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb241-5"><a href="an-introduction-to-object-oriented-programming.html#cb241-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, known_var):</span>
<span id="cb241-6"><a href="an-introduction-to-object-oriented-programming.html#cb241-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mean <span class="op">=</span> RunningMean()</span>
<span id="cb241-7"><a href="an-introduction-to-object-oriented-programming.html#cb241-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.known_var <span class="op">=</span> known_var</span>
<span id="cb241-8"><a href="an-introduction-to-object-oriented-programming.html#cb241-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb241-9"><a href="an-introduction-to-object-oriented-programming.html#cb241-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> update(<span class="va">self</span>, new_x):    </span>
<span id="cb241-10"><a href="an-introduction-to-object-oriented-programming.html#cb241-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mean.update(new_x)</span>
<span id="cb241-11"><a href="an-introduction-to-object-oriented-programming.html#cb241-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb241-12"><a href="an-introduction-to-object-oriented-programming.html#cb241-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_current_interval(<span class="va">self</span>):</span>
<span id="cb241-13"><a href="an-introduction-to-object-oriented-programming.html#cb241-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.n <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb241-14"><a href="an-introduction-to-object-oriented-programming.html#cb241-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb241-15"><a href="an-introduction-to-object-oriented-programming.html#cb241-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb241-16"><a href="an-introduction-to-object-oriented-programming.html#cb241-16" aria-hidden="true" tabindex="-1"></a>            half_width <span class="op">=</span> <span class="fl">1.96</span> <span class="op">*</span> np.sqrt(<span class="va">self</span>.known_var <span class="op">/</span> <span class="va">self</span>.n)  </span>
<span id="cb241-17"><a href="an-introduction-to-object-oriented-programming.html#cb241-17" aria-hidden="true" tabindex="-1"></a>            left <span class="op">=</span> <span class="va">self</span>.mean.get_current_xbar() <span class="op">-</span> half_width</span>
<span id="cb241-18"><a href="an-introduction-to-object-oriented-programming.html#cb241-18" aria-hidden="true" tabindex="-1"></a>            right <span class="op">=</span> <span class="va">self</span>.mean.get_current_xbar() <span class="op">+</span> half_width</span>
<span id="cb241-19"><a href="an-introduction-to-object-oriented-programming.html#cb241-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> np.array([left, right])</span></code></pre></div>
</div>
</div>
<div id="oop-in-r" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> OOP In R<a href="an-introduction-to-object-oriented-programming.html#oop-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R, unlike Python, has many different kinds of classes. In R, there is not only one way to make a class. There are many! I will discuss</p>
<ul>
<li>S3 classes,</li>
<li>S4 classes,</li>
<li>Reference classes, and</li>
<li>R6 classes.</li>
</ul>
<p>If you like how Python does OOP, you will like reference classes and R6 classes, while S3 and S4 classes will feel strange to you.</p>
<p>It’s best to learn about them chronologically, in my opinion. S3 classes came first, S4 classes sought to improve upon those. Reference classes rely on S4 classes, and R6 classes are an improved version of Reference classes <span class="citation">(<a href="#ref-wickham2014advanced" role="doc-biblioref">H. Wickham 2014</a>)</span>.</p>
<div id="s3-objects-the-big-picture" class="section level3 hasAnchor" number="14.2.1">
<h3><span class="header-section-number">14.2.1</span> S3 objects: The Big Picture<a href="an-introduction-to-object-oriented-programming.html#s3-objects-the-big-picture" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With S3 (and S4) objects, calling a method <code>print()</code> will not look like this.</p>
<pre><code>my_obj.print()</code></pre>
<p>Instead, it will look like this:</p>
<pre><code>print(my_obj)</code></pre>
<p>The primary goal of S3 is <em>polymorphism</em> <span class="citation">(<a href="#ref-grolemund2014hands" role="doc-biblioref">Grolemund 2014</a>)</span>. We want functions like <code>print()</code>, <code>summary()</code> and <code>plot()</code> to behave differently when objects of a different type are passed in to them. Printing a linear model should look a lot different than printing a data frame, right? So we can write code like the following, we only have to remember fewer functions as an end-user, and the “right” thing will always happen. If you’re writing a package, it’s also nice for your users that they’re able to use the regular functions that they’re familiar with. For instance, I allow users of my package <a href="https://cran.r-project.org/web/packages/cPseudoMaRg/index.html"><code>cPseudoMaRg</code></a> <span class="citation">(<a href="#ref-cpm" role="doc-biblioref">Brown 2021</a>)</span> to call <code>print()</code> on objects of type <code>cpmResults</code>. In section <a href="visualization.html#plotting-with-ggplot2">13.2</a>, <code>ggplot2</code> instances, which are much more complicated than plain <code>numeric</code> <code>vector</code>s, are <code>+</code>ed together.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="an-introduction-to-object-oriented-programming.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print works on pretty much everything</span></span>
<span id="cb244-2"><a href="an-introduction-to-object-oriented-programming.html#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(myObj)</span>
<span id="cb244-3"><a href="an-introduction-to-object-oriented-programming.html#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(myObjOfADifferentClass)</span>
<span id="cb244-4"><a href="an-introduction-to-object-oriented-programming.html#cb244-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(aThirdClassObject)</span></code></pre></div>
<p>This works because these “high-level” functions (such as <code>print()</code>), will look at its input and choose the most appropriate function to call, based on what kind of type the input has. <code>print()</code> is the high-level function. When you run some of the above code, it might not be obvious which specific function <code>print()</code> chooses for each input. You can’t see that happening, yet.</p>
<p>Last, recall that this discussion only applies to S3 objects. Not all objects are S3 objects, though. To find out if an object <code>x</code> is an S3 object, use <code>is.object(x)</code>.</p>
</div>
<div id="using-s3-objects" class="section level3 hasAnchor" number="14.2.2">
<h3><span class="header-section-number">14.2.2</span> Using S3 objects<a href="an-introduction-to-object-oriented-programming.html#using-s3-objects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using S3 objects is so easy that you probably don’t even know that you’re actually using them. You can just try to call functions on objects, look at the output, and if you’re happy with it, you’re good. However, if you’ve ever asked yourself: “why does <code>print()</code> (or another function) do different things all the time?” then this section will be useful to you.</p>
<p><code>print()</code> is a <a href="https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Method-dispatching"><strong>generic function</strong></a> which is a function that looks at the type of its first argument, and then calls another, more specialized function depending on what type that argument is. Not all functions in R are generic, but some are. In addition to <code>print()</code>, <code>summary()</code> and <code>plot()</code> are the most ubiquitous generic functions. Generic functions are an <em>interface</em>, because the user does not need to concern himself with the details going on behind the scenes.</p>
<p>In R, a <strong>method</strong> is a specialized function that gets chosen by the generic function for a particular type of input. The method is the <em>implementation</em>. When the generic function chooses a particular method, this is called <strong>method dispatch</strong>.</p>
<p>If you look at the definition of a generic function, let’s take <code>plot()</code> for instance, it has a single line that calls <code>UseMethod()</code>.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="an-introduction-to-object-oriented-programming.html#cb245-1" aria-hidden="true" tabindex="-1"></a>plot</span></code></pre></div>
<pre><code>## function (x, y, ...) 
## UseMethod(&quot;plot&quot;)
## &lt;bytecode: 0x55a6feb10b38&gt;
## &lt;environment: namespace:base&gt;</code></pre>
<p><code>UseMethod()</code> performs method dispatch. Which methods can be dispatched to? To see that, use the <code>methods()</code> function.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="an-introduction-to-object-oriented-programming.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">methods</span>(plot))</span></code></pre></div>
<pre><code>## [1] 39</code></pre>
<p>All of these S3 class methods share the same naming convention. Their name has the generic function’s name as a prefix, then a dot (<code>.</code>), then the name of the class that they are specifically written to be used with.</p>
<div class="rmd-caution">
<p>R’s dot-notation is nothing like Python’s dot-notation! In R, functions do not <em>belong</em> to types/classes like they do in Python!</p>
</div>
<p>Method dispatch works by looking at the <code>class</code> attribute of an S3 object argument. An object in R may or may not have a set of <a href="https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Attributes"><strong>attributes</strong></a>, which are a collection of name/value pairs that give a particular object extra functionality. Regular <code>vector</code>s in R don’t have attributes (e.g. try running <code>attributes(1:3)</code>), but objects that are “embellished” versions of a <code>vector</code> might (e.g. run <code>attributes(factor(1:3))</code>). Attributes in R are similar to attributes in Python, but they are usually only used as “tags” to elicit some sort of behavior when the object is passed into a function.</p>
<div class="rmd-caution">
<p><code>class()</code> will return misleading results if it’s called on an object that isn’t an S3 object. Make sure to check with <code>is.object()</code> first.</p>
</div>
<p>Also, these methods are not <em>encapsulated</em> inside a class definition like they are in Python, either. They just look like loose functions–the method definition for a particular class is not defined inside the class. These class methods can be defined just as ordinary functions, out on their own, in whatever file you think is appropriate to define functions in.</p>
<p>As an example, let’s try to <code>plot()</code> some specific objects.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="an-introduction-to-object-oriented-programming.html#cb249-1" aria-hidden="true" tabindex="-1"></a>aDF <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">nrow =</span> <span class="dv">10</span>))</span>
<span id="cb249-2"><a href="an-introduction-to-object-oriented-programming.html#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.object</span>(aDF) <span class="co"># is this s3?</span></span>
<span id="cb249-3"><a href="an-introduction-to-object-oriented-programming.html#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb249-4"><a href="an-introduction-to-object-oriented-programming.html#cb249-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(aDF)</span>
<span id="cb249-5"><a href="an-introduction-to-object-oriented-programming.html#cb249-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;data.frame&quot;</span></span>
<span id="cb249-6"><a href="an-introduction-to-object-oriented-programming.html#cb249-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aDF)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-246"></span>
<img src="r_and_python_book_files/figure-html/unnamed-chunk-246-1.png" alt="A Scatterplot Matrix" width="80%" />
<p class="caption">
Figure 14.1: A Scatterplot Matrix
</p>
</div>
<p>Because <code>aDF</code> has its <code>class</code> set to <code>data.frame</code>, this causes <code>plot()</code> to try to find a <code>plot.data.frame()</code> method. If this method was not found, R would attempt to find/use a <code>plot.default()</code> method. If no default method existed, an error would be thrown.</p>
<p>As another example, we can play around with objects created with the <code>ecdf()</code> function. This function computes an <em>empirical cumulative distribution function</em>, which takes a real number as an input, and outputs the proportion of observations that are less than or equal to that input<a href="#fn25" class="footnote-ref" id="fnref25"><sup>25</sup></a></p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="an-introduction-to-object-oriented-programming.html#cb250-1" aria-hidden="true" tabindex="-1"></a>myECDF <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>))</span>
<span id="cb250-2"><a href="an-introduction-to-object-oriented-programming.html#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.object</span>(myECDF)</span>
<span id="cb250-3"><a href="an-introduction-to-object-oriented-programming.html#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb250-4"><a href="an-introduction-to-object-oriented-programming.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(myECDF)</span>
<span id="cb250-5"><a href="an-introduction-to-object-oriented-programming.html#cb250-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;ecdf&quot;     &quot;stepfun&quot;  &quot;function&quot;</span></span>
<span id="cb250-6"><a href="an-introduction-to-object-oriented-programming.html#cb250-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myECDF)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-247"></span>
<img src="r_and_python_book_files/figure-html/unnamed-chunk-247-1.png" alt="Plotting an Empirical Cumulative Distribution Function" width="80%" />
<p class="caption">
Figure 14.2: Plotting an Empirical Cumulative Distribution Function
</p>
</div>
<p>This is how <em>inheritance</em> works in S3. The <code>ecdf</code> class inherits from the <code>stepfun</code> class, which in turn inherits from the <code>function</code> class. When you call <code>plot(myECDF)</code>, ultimately <code>plot.ecdf()</code> is used on this object. However, if <code>plot.ecdf()</code> did not exist, <code>plot.stepfun()</code> would be tried. S3 inheritance in R is much simpler than Python’s inheritance!</p>
</div>
<div id="creating-s3-objects" class="section level3 hasAnchor" number="14.2.3">
<h3><span class="header-section-number">14.2.3</span> Creating S3 objects<a href="an-introduction-to-object-oriented-programming.html#creating-s3-objects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Creating an S3 object is very easy, and is a nice way to spruce up some bundled up object that you’re returning from a function, say. All you have to do is tag an object by changing its class attribute. Just assign a character <code>vector</code> to it!</p>
<p>Here is an example of creating an object of <code>CoolClass</code>.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="an-introduction-to-object-oriented-programming.html#cb251-1" aria-hidden="true" tabindex="-1"></a>myThing <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb251-2"><a href="an-introduction-to-object-oriented-programming.html#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(myThing)</span>
<span id="cb251-3"><a href="an-introduction-to-object-oriented-programming.html#cb251-3" aria-hidden="true" tabindex="-1"></a><span class="do">## NULL</span></span>
<span id="cb251-4"><a href="an-introduction-to-object-oriented-programming.html#cb251-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(myThing) <span class="ot">&lt;-</span> <span class="st">&quot;CoolClass&quot;</span></span>
<span id="cb251-5"><a href="an-introduction-to-object-oriented-programming.html#cb251-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(myThing) <span class="co"># also try class(myThing)</span></span>
<span id="cb251-6"><a href="an-introduction-to-object-oriented-programming.html#cb251-6" aria-hidden="true" tabindex="-1"></a><span class="do">## $class</span></span>
<span id="cb251-7"><a href="an-introduction-to-object-oriented-programming.html#cb251-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;CoolClass&quot;</span></span></code></pre></div>
<p><code>myThing</code> is now an instance of <code>CoolClass</code>, even though I never defined what a <code>CoolClass</code> was ahead of time! If you’re used to Python, this should seem very strange. Compared to Python, this approach is very flexible, but also, kind of dangerous, because you can change the <code>class</code>es of existing objects. You shouldn’t do that, but you could if you wanted to.</p>
<p>After you start creating your own S3 objects, you can write your own methods associated with these objects. That way, when a user of your code uses typical generic functions, such as <code>summary()</code>, on your S3 object, you can control what interesting things will happen to the user of your package. Here’s an example.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="an-introduction-to-object-oriented-programming.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(myThing)</span>
<span id="cb252-2"><a href="an-introduction-to-object-oriented-programming.html#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;No summary available!&quot;</span></span>
<span id="cb252-3"><a href="an-introduction-to-object-oriented-programming.html#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Cool Classes are too cool for summaries!&quot;</span></span>
<span id="cb252-4"><a href="an-introduction-to-object-oriented-programming.html#cb252-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;:)&quot;</span></span></code></pre></div>
<p>The <code>summary()</code> method I wrote for this class is the following.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="an-introduction-to-object-oriented-programming.html#cb253-1" aria-hidden="true" tabindex="-1"></a>summary.CoolClass <span class="ot">&lt;-</span> <span class="cf">function</span>(object,...){</span>
<span id="cb253-2"><a href="an-introduction-to-object-oriented-programming.html#cb253-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;No summary available!&quot;</span>)</span>
<span id="cb253-3"><a href="an-introduction-to-object-oriented-programming.html#cb253-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Cool Classes are too cool for summaries!&quot;</span>)</span>
<span id="cb253-4"><a href="an-introduction-to-object-oriented-programming.html#cb253-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;:)&quot;</span>)</span>
<span id="cb253-5"><a href="an-introduction-to-object-oriented-programming.html#cb253-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>When writing this, I kept the signature the same as <code>summary()</code>’s.</p>
</div>
<div id="s4-objects-the-big-picture" class="section level3 hasAnchor" number="14.2.4">
<h3><span class="header-section-number">14.2.4</span> S4 objects: The Big Picture<a href="an-introduction-to-object-oriented-programming.html#s4-objects-the-big-picture" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>S4 was developed after S3. If you look at your search path (type <code>search()</code>), you will see <code>package:methods</code>. That’s where all the code you need to do S4 is. Here are the similarities and differences between S3 and S4.</p>
<ul>
<li>They both use generic functions and methods work in the same way.</li>
<li>Unlike in S3, S4 classes allow you to use multiple dispatch, which means the generic function can dispatch on multiple arguments, instead of just the first argument.</li>
<li>S4 class definitions are strict–they aren’t just name tags like in S3.</li>
<li>S4 inheritance feels more like Python’s. You can think of a base class object living inside a child class object.</li>
<li>S4 classes can have default data members via <code>prototype</code>s.</li>
</ul>
<p>Much more information about S4 classes can be obtained by reading <a href="https://adv-r.hadley.nz/s4.html">Chapter 15 in Hadley Wickham’s book.</a></p>
</div>
<div id="using-s4-objects" class="section level3 hasAnchor" number="14.2.5">
<h3><span class="header-section-number">14.2.5</span> Using S4 objects<a href="an-introduction-to-object-oriented-programming.html#using-s4-objects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One CRAN package that uses S4 is the <a href="https://cran.r-project.org/web/packages/Matrix/vignettes/Intro2Matrix.pdf">Matrix package.</a> S4 objects are also extremely popular in packages hosted on <a href="https://www.bioconductor.org/">Bioconductor</a>.</p>
<div class="rmd-details">
<p>Bioconductor is kind of like CRAN, but its software has a much more specific focus on bioinformatics. To download packages from Bioconductor, you can check out the installation instructions provided <a href="https://bioconductor.org/help/course-materials/2017/Zurich/S4-classes-and-methods.html">here</a>.</p>
</div>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="an-introduction-to-object-oriented-programming.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Matrix)</span>
<span id="cb254-2"><a href="an-introduction-to-object-oriented-programming.html#cb254-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">Matrix</span>(<span class="dv">10</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">28</span>, <span class="dv">4</span>, <span class="dv">7</span>)</span>
<span id="cb254-3"><a href="an-introduction-to-object-oriented-programming.html#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="fu">isS4</span>(M)</span>
<span id="cb254-4"><a href="an-introduction-to-object-oriented-programming.html#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb254-5"><a href="an-introduction-to-object-oriented-programming.html#cb254-5" aria-hidden="true" tabindex="-1"></a>M</span>
<span id="cb254-6"><a href="an-introduction-to-object-oriented-programming.html#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 x 7 Matrix of class &quot;dgeMatrix&quot;</span></span>
<span id="cb254-7"><a href="an-introduction-to-object-oriented-programming.html#cb254-7" aria-hidden="true" tabindex="-1"></a><span class="do">##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span></span>
<span id="cb254-8"><a href="an-introduction-to-object-oriented-programming.html#cb254-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]   11   15   19   23   27   31   35</span></span>
<span id="cb254-9"><a href="an-introduction-to-object-oriented-programming.html#cb254-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,]   12   16   20   24   28   32   36</span></span>
<span id="cb254-10"><a href="an-introduction-to-object-oriented-programming.html#cb254-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,]   13   17   21   25   29   33   37</span></span>
<span id="cb254-11"><a href="an-introduction-to-object-oriented-programming.html#cb254-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [4,]   14   18   22   26   30   34   38</span></span>
<span id="cb254-12"><a href="an-introduction-to-object-oriented-programming.html#cb254-12" aria-hidden="true" tabindex="-1"></a>M<span class="sc">@</span>Dim</span>
<span id="cb254-13"><a href="an-introduction-to-object-oriented-programming.html#cb254-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 4 7</span></span></code></pre></div>
<p>Inside an S4 object, data members are called <strong>slots</strong>, and they are accessed with the <code>@</code> operator (instead of the <code>$</code> operator). Objects can be tested if they are S4 with the function <code>isS4()</code>. Otherwise, they look and feel just like S3 objects.</p>
</div>
<div id="creating-s4-objects" class="section level3 hasAnchor" number="14.2.6">
<h3><span class="header-section-number">14.2.6</span> Creating S4 objects<a href="an-introduction-to-object-oriented-programming.html#creating-s4-objects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here are the key takeaways:</p>
<ul>
<li>create a new S4 class with <code>setClass()</code>,</li>
<li>create a new S4 object with <code>new()</code>,</li>
<li>S4 classes have a fixed amount of slots, a name, and a fixed inheritance structure.</li>
</ul>
<p>Let’s do an example that resembles the example we did in Python, where we defined a <code>RunningMean</code> class and a <code>RunningCI</code> class.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="an-introduction-to-object-oriented-programming.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setClass</span>(<span class="st">&quot;RunningMean&quot;</span>,</span>
<span id="cb255-2"><a href="an-introduction-to-object-oriented-programming.html#cb255-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">slots =</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="st">&quot;integer&quot;</span>, </span>
<span id="cb255-3"><a href="an-introduction-to-object-oriented-programming.html#cb255-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">currentXbar =</span> <span class="st">&quot;numeric&quot;</span>))</span>
<span id="cb255-4"><a href="an-introduction-to-object-oriented-programming.html#cb255-4" aria-hidden="true" tabindex="-1"></a><span class="fu">setClass</span>(<span class="st">&quot;RunningCI&quot;</span>,</span>
<span id="cb255-5"><a href="an-introduction-to-object-oriented-programming.html#cb255-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">slots =</span> <span class="fu">list</span>(<span class="at">knownVar =</span> <span class="st">&quot;numeric&quot;</span>),</span>
<span id="cb255-6"><a href="an-introduction-to-object-oriented-programming.html#cb255-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">contains =</span> <span class="st">&quot;RunningMean&quot;</span>)</span></code></pre></div>
<p>Here, unlike in S3 class’s, we actually have to define a class with <code>setClass()</code>. In the parlance of S4, <code>slots=</code> are a class’ data members, and <code>contains=</code> signals that one class inherits from another (even though it kind of sounds like <em>composition</em>).</p>
<p>New objects can be created with the <code>new()</code> function after this is accomplished.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="an-introduction-to-object-oriented-programming.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">new</span>(<span class="st">&quot;RunningMean&quot;</span>, <span class="at">n =</span> 0L, <span class="at">currentXbar =</span> <span class="dv">0</span>)</span>
<span id="cb256-2"><a href="an-introduction-to-object-oriented-programming.html#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="fu">new</span>(<span class="st">&quot;RunningCI&quot;</span>, <span class="at">n =</span> 0L, <span class="at">currentXbar =</span> <span class="dv">0</span>, <span class="at">knownVar =</span> <span class="fl">1.0</span>)</span></code></pre></div>
<p>Next we want to define an <code>update()</code> generic function that will work on objects of both types. This is what gives us <em>polymorphism</em> . The generic <code>update()</code> will call specialized methods for objects of class <code>RunningMean</code> and <code>RunningCI</code>.</p>
<p>Recall that in the Python example, each class had its own update method. Here, we still have a specialized method for each class, but S4 methods don’t have to be defined inside the class definition, as we can see below.</p>
<pre><code>## Creating a new generic function for &#39;update&#39; in the global environment
## [1] &quot;update&quot;</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="an-introduction-to-object-oriented-programming.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setGeneric</span>(<span class="st">&quot;update&quot;</span>, <span class="cf">function</span>(oldMean, newNum) {</span>
<span id="cb258-2"><a href="an-introduction-to-object-oriented-programming.html#cb258-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">standardGeneric</span>(<span class="st">&quot;update&quot;</span>)</span>
<span id="cb258-3"><a href="an-introduction-to-object-oriented-programming.html#cb258-3" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb258-4"><a href="an-introduction-to-object-oriented-programming.html#cb258-4" aria-hidden="true" tabindex="-1"></a><span class="fu">setMethod</span>(<span class="st">&quot;update&quot;</span>,</span>
<span id="cb258-5"><a href="an-introduction-to-object-oriented-programming.html#cb258-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">c</span>(<span class="at">oldMean =</span> <span class="st">&quot;RunningMean&quot;</span>, <span class="at">newNum =</span> <span class="st">&quot;numeric&quot;</span>),</span>
<span id="cb258-6"><a href="an-introduction-to-object-oriented-programming.html#cb258-6" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(oldMean, newNum) {</span>
<span id="cb258-7"><a href="an-introduction-to-object-oriented-programming.html#cb258-7" aria-hidden="true" tabindex="-1"></a>            oldN <span class="ot">&lt;-</span> oldMean<span class="sc">@</span>n</span>
<span id="cb258-8"><a href="an-introduction-to-object-oriented-programming.html#cb258-8" aria-hidden="true" tabindex="-1"></a>            oldAve <span class="ot">&lt;-</span> oldMean<span class="sc">@</span>currentXbar</span>
<span id="cb258-9"><a href="an-introduction-to-object-oriented-programming.html#cb258-9" aria-hidden="true" tabindex="-1"></a>            newAve <span class="ot">&lt;-</span> (oldAve<span class="sc">*</span>oldN <span class="sc">+</span> newNum)<span class="sc">/</span>(oldN <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb258-10"><a href="an-introduction-to-object-oriented-programming.html#cb258-10" aria-hidden="true" tabindex="-1"></a>            newN <span class="ot">&lt;-</span> oldN <span class="sc">+</span> 1L</span>
<span id="cb258-11"><a href="an-introduction-to-object-oriented-programming.html#cb258-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="fu">new</span>(<span class="st">&quot;RunningMean&quot;</span>, <span class="at">n =</span> newN, <span class="at">currentXbar =</span> newAve))</span>
<span id="cb258-12"><a href="an-introduction-to-object-oriented-programming.html#cb258-12" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb258-13"><a href="an-introduction-to-object-oriented-programming.html#cb258-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb258-14"><a href="an-introduction-to-object-oriented-programming.html#cb258-14" aria-hidden="true" tabindex="-1"></a><span class="fu">setMethod</span>(<span class="st">&quot;update&quot;</span>,</span>
<span id="cb258-15"><a href="an-introduction-to-object-oriented-programming.html#cb258-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">c</span>(<span class="at">oldMean =</span> <span class="st">&quot;RunningCI&quot;</span>, <span class="at">newNum =</span> <span class="st">&quot;numeric&quot;</span>),</span>
<span id="cb258-16"><a href="an-introduction-to-object-oriented-programming.html#cb258-16" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(oldMean, newNum) {</span>
<span id="cb258-17"><a href="an-introduction-to-object-oriented-programming.html#cb258-17" aria-hidden="true" tabindex="-1"></a>            oldN <span class="ot">&lt;-</span> oldMean<span class="sc">@</span>n</span>
<span id="cb258-18"><a href="an-introduction-to-object-oriented-programming.html#cb258-18" aria-hidden="true" tabindex="-1"></a>            oldAve <span class="ot">&lt;-</span> oldMean<span class="sc">@</span>currentXbar</span>
<span id="cb258-19"><a href="an-introduction-to-object-oriented-programming.html#cb258-19" aria-hidden="true" tabindex="-1"></a>            newAve <span class="ot">&lt;-</span> (oldAve<span class="sc">*</span>oldN <span class="sc">+</span> newNum)<span class="sc">/</span>(oldN <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb258-20"><a href="an-introduction-to-object-oriented-programming.html#cb258-20" aria-hidden="true" tabindex="-1"></a>            newN <span class="ot">&lt;-</span> oldN <span class="sc">+</span> 1L</span>
<span id="cb258-21"><a href="an-introduction-to-object-oriented-programming.html#cb258-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="fu">new</span>(<span class="st">&quot;RunningCI&quot;</span>, <span class="at">n =</span> newN, <span class="at">currentXbar =</span> newAve, </span>
<span id="cb258-22"><a href="an-introduction-to-object-oriented-programming.html#cb258-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">knownVar =</span> oldMean<span class="sc">@</span>knownVar))</span>
<span id="cb258-23"><a href="an-introduction-to-object-oriented-programming.html#cb258-23" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb258-24"><a href="an-introduction-to-object-oriented-programming.html#cb258-24" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Here’s a demonstration of using these two classes that mirrors the example in subsection <a href="an-introduction-to-object-oriented-programming.html#adding-inheritance">14.1.3</a></p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="an-introduction-to-object-oriented-programming.html#cb259-1" aria-hidden="true" tabindex="-1"></a>myAve <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;RunningMean&quot;</span>, <span class="at">n =</span> 0L, <span class="at">currentXbar =</span> <span class="dv">0</span>)</span>
<span id="cb259-2"><a href="an-introduction-to-object-oriented-programming.html#cb259-2" aria-hidden="true" tabindex="-1"></a>myAve <span class="ot">&lt;-</span> <span class="fu">update</span>(myAve, <span class="dv">3</span>)</span>
<span id="cb259-3"><a href="an-introduction-to-object-oriented-programming.html#cb259-3" aria-hidden="true" tabindex="-1"></a>myAve</span>
<span id="cb259-4"><a href="an-introduction-to-object-oriented-programming.html#cb259-4" aria-hidden="true" tabindex="-1"></a><span class="do">## An object of class &quot;RunningMean&quot;</span></span>
<span id="cb259-5"><a href="an-introduction-to-object-oriented-programming.html#cb259-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Slot &quot;n&quot;:</span></span>
<span id="cb259-6"><a href="an-introduction-to-object-oriented-programming.html#cb259-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span>
<span id="cb259-7"><a href="an-introduction-to-object-oriented-programming.html#cb259-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb259-8"><a href="an-introduction-to-object-oriented-programming.html#cb259-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Slot &quot;currentXbar&quot;:</span></span>
<span id="cb259-9"><a href="an-introduction-to-object-oriented-programming.html#cb259-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 3</span></span>
<span id="cb259-10"><a href="an-introduction-to-object-oriented-programming.html#cb259-10" aria-hidden="true" tabindex="-1"></a>myAve <span class="ot">&lt;-</span> <span class="fu">update</span>(myAve, <span class="dv">1</span>)</span>
<span id="cb259-11"><a href="an-introduction-to-object-oriented-programming.html#cb259-11" aria-hidden="true" tabindex="-1"></a>myAve</span>
<span id="cb259-12"><a href="an-introduction-to-object-oriented-programming.html#cb259-12" aria-hidden="true" tabindex="-1"></a><span class="do">## An object of class &quot;RunningMean&quot;</span></span>
<span id="cb259-13"><a href="an-introduction-to-object-oriented-programming.html#cb259-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Slot &quot;n&quot;:</span></span>
<span id="cb259-14"><a href="an-introduction-to-object-oriented-programming.html#cb259-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2</span></span>
<span id="cb259-15"><a href="an-introduction-to-object-oriented-programming.html#cb259-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb259-16"><a href="an-introduction-to-object-oriented-programming.html#cb259-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Slot &quot;currentXbar&quot;:</span></span>
<span id="cb259-17"><a href="an-introduction-to-object-oriented-programming.html#cb259-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2</span></span>
<span id="cb259-18"><a href="an-introduction-to-object-oriented-programming.html#cb259-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-19"><a href="an-introduction-to-object-oriented-programming.html#cb259-19" aria-hidden="true" tabindex="-1"></a>myCI <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;RunningCI&quot;</span>, <span class="at">n =</span> 0L, <span class="at">currentXbar =</span> <span class="dv">0</span>, <span class="at">knownVar =</span> <span class="fl">1.0</span>)</span>
<span id="cb259-20"><a href="an-introduction-to-object-oriented-programming.html#cb259-20" aria-hidden="true" tabindex="-1"></a>myCI <span class="ot">&lt;-</span> <span class="fu">update</span>(myCI, <span class="dv">3</span>)</span>
<span id="cb259-21"><a href="an-introduction-to-object-oriented-programming.html#cb259-21" aria-hidden="true" tabindex="-1"></a>myCI</span>
<span id="cb259-22"><a href="an-introduction-to-object-oriented-programming.html#cb259-22" aria-hidden="true" tabindex="-1"></a><span class="do">## An object of class &quot;RunningCI&quot;</span></span>
<span id="cb259-23"><a href="an-introduction-to-object-oriented-programming.html#cb259-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Slot &quot;knownVar&quot;:</span></span>
<span id="cb259-24"><a href="an-introduction-to-object-oriented-programming.html#cb259-24" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span>
<span id="cb259-25"><a href="an-introduction-to-object-oriented-programming.html#cb259-25" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb259-26"><a href="an-introduction-to-object-oriented-programming.html#cb259-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Slot &quot;n&quot;:</span></span>
<span id="cb259-27"><a href="an-introduction-to-object-oriented-programming.html#cb259-27" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span>
<span id="cb259-28"><a href="an-introduction-to-object-oriented-programming.html#cb259-28" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb259-29"><a href="an-introduction-to-object-oriented-programming.html#cb259-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Slot &quot;currentXbar&quot;:</span></span>
<span id="cb259-30"><a href="an-introduction-to-object-oriented-programming.html#cb259-30" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 3</span></span>
<span id="cb259-31"><a href="an-introduction-to-object-oriented-programming.html#cb259-31" aria-hidden="true" tabindex="-1"></a>myCI <span class="ot">&lt;-</span> <span class="fu">update</span>(myCI, <span class="dv">1</span>)</span>
<span id="cb259-32"><a href="an-introduction-to-object-oriented-programming.html#cb259-32" aria-hidden="true" tabindex="-1"></a>myCI</span>
<span id="cb259-33"><a href="an-introduction-to-object-oriented-programming.html#cb259-33" aria-hidden="true" tabindex="-1"></a><span class="do">## An object of class &quot;RunningCI&quot;</span></span>
<span id="cb259-34"><a href="an-introduction-to-object-oriented-programming.html#cb259-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Slot &quot;knownVar&quot;:</span></span>
<span id="cb259-35"><a href="an-introduction-to-object-oriented-programming.html#cb259-35" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span>
<span id="cb259-36"><a href="an-introduction-to-object-oriented-programming.html#cb259-36" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb259-37"><a href="an-introduction-to-object-oriented-programming.html#cb259-37" aria-hidden="true" tabindex="-1"></a><span class="do">## Slot &quot;n&quot;:</span></span>
<span id="cb259-38"><a href="an-introduction-to-object-oriented-programming.html#cb259-38" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2</span></span>
<span id="cb259-39"><a href="an-introduction-to-object-oriented-programming.html#cb259-39" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb259-40"><a href="an-introduction-to-object-oriented-programming.html#cb259-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Slot &quot;currentXbar&quot;:</span></span>
<span id="cb259-41"><a href="an-introduction-to-object-oriented-programming.html#cb259-41" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2</span></span></code></pre></div>
<p>This looks more <em>functional</em> (more information on functional programming is available in chapter <a href="an-introduction-to-functional-programming.html#an-introduction-to-functional-programming">15</a>) than the Python example because the <code>update()</code> function does not change an object with a side-effect. Instead, it takes the old object, changes it, returns the new object, and uses assignment to overwrite the object. The benefit of this approach is that the assignment operator (<code>&lt;-</code>) signals to us that something is changing. However, there is more data copying involved, so the program is presumably slower than it needs to be.</p>
<p>The big takeaway here is that S3 and S4 don’t feel like Python’s encapsulated OOP. If we wanted to write stateful programs, we might consider using Reference Classes, or R6 classes.</p>
</div>
<div id="reference-classes-the-big-picture" class="section level3 hasAnchor" number="14.2.7">
<h3><span class="header-section-number">14.2.7</span> Reference Classes: The Big Picture<a href="an-introduction-to-object-oriented-programming.html#reference-classes-the-big-picture" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://www.rdocumentation.org/packages/methods/versions/3.6.2/topics/ReferenceClasses"><strong>Reference Classes</strong></a> are built on top of S4 classes, and were released in late 2010. They feel very different from S3 and S4 classes, and they more closely resemble Python classes, because</p>
<ol style="list-style-type: decimal">
<li>their method definitions are <em>encapsulated</em> inside class definitions like in Python, and</li>
<li>the objects they construct are <em>mutable</em>.</li>
</ol>
<p>So it will feel much more like Python’s class system. Some might say using reference classes that will lead to code that is not very R-ish, but it can be useful for certain types of programs (e.g. long-running code, code that that performs many/high-dimensional/complicated simulations, or code that circumvents storing large data set in your computer’s memory all at once).</p>
</div>
<div id="creating-reference-classes" class="section level3 hasAnchor" number="14.2.8">
<h3><span class="header-section-number">14.2.8</span> Creating Reference Classes<a href="an-introduction-to-object-oriented-programming.html#creating-reference-classes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Creating reference classes is done with the function <code>setRefClass</code>. I create a class called <code>RunningMean</code> that produces the same behavior as that in the previous example.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="an-introduction-to-object-oriented-programming.html#cb260-1" aria-hidden="true" tabindex="-1"></a>RunningMeanRC <span class="ot">&lt;-</span> <span class="fu">setRefClass</span>(<span class="st">&quot;RunningMeanRC&quot;</span>, </span>
<span id="cb260-2"><a href="an-introduction-to-object-oriented-programming.html#cb260-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fields =</span> <span class="fu">list</span>(<span class="at">current_xbar =</span> <span class="st">&quot;numeric&quot;</span>,</span>
<span id="cb260-3"><a href="an-introduction-to-object-oriented-programming.html#cb260-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">n =</span> <span class="st">&quot;integer&quot;</span>),</span>
<span id="cb260-4"><a href="an-introduction-to-object-oriented-programming.html#cb260-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">methods =</span> <span class="fu">list</span>(</span>
<span id="cb260-5"><a href="an-introduction-to-object-oriented-programming.html#cb260-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">update =</span> <span class="cf">function</span>(new_x){</span>
<span id="cb260-6"><a href="an-introduction-to-object-oriented-programming.html#cb260-6" aria-hidden="true" tabindex="-1"></a>                                 n <span class="ot">&lt;&lt;-</span> n <span class="sc">+</span> 1L</span>
<span id="cb260-7"><a href="an-introduction-to-object-oriented-programming.html#cb260-7" aria-hidden="true" tabindex="-1"></a>                                 new_sum <span class="ot">&lt;-</span> current_xbar<span class="sc">*</span>(n<span class="dv">-1</span>) <span class="sc">+</span> new_x</span>
<span id="cb260-8"><a href="an-introduction-to-object-oriented-programming.html#cb260-8" aria-hidden="true" tabindex="-1"></a>                                 current_xbar <span class="ot">&lt;&lt;-</span> new_sum<span class="sc">/</span>n</span>
<span id="cb260-9"><a href="an-introduction-to-object-oriented-programming.html#cb260-9" aria-hidden="true" tabindex="-1"></a>                                }))</span></code></pre></div>
<p>This tells us a few things. First, data members are called <em>fields</em> now. Second, changing class variables is done with the <code>&lt;&lt;-</code>. We can use it just as before.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="an-introduction-to-object-oriented-programming.html#cb261-1" aria-hidden="true" tabindex="-1"></a>my_ave <span class="ot">&lt;-</span> RunningMeanRC<span class="sc">$</span><span class="fu">new</span>(<span class="at">current_xbar=</span><span class="dv">0</span>, <span class="at">n=</span>0L)</span>
<span id="cb261-2"><a href="an-introduction-to-object-oriented-programming.html#cb261-2" aria-hidden="true" tabindex="-1"></a>my_ave</span>
<span id="cb261-3"><a href="an-introduction-to-object-oriented-programming.html#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Reference class object of class &quot;RunningMeanRC&quot;</span></span>
<span id="cb261-4"><a href="an-introduction-to-object-oriented-programming.html#cb261-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Field &quot;current_xbar&quot;:</span></span>
<span id="cb261-5"><a href="an-introduction-to-object-oriented-programming.html#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0</span></span>
<span id="cb261-6"><a href="an-introduction-to-object-oriented-programming.html#cb261-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Field &quot;n&quot;:</span></span>
<span id="cb261-7"><a href="an-introduction-to-object-oriented-programming.html#cb261-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0</span></span>
<span id="cb261-8"><a href="an-introduction-to-object-oriented-programming.html#cb261-8" aria-hidden="true" tabindex="-1"></a>my_ave<span class="sc">$</span><span class="fu">update</span>(<span class="fl">1.</span>) </span>
<span id="cb261-9"><a href="an-introduction-to-object-oriented-programming.html#cb261-9" aria-hidden="true" tabindex="-1"></a>my_ave<span class="sc">$</span>current_xbar</span>
<span id="cb261-10"><a href="an-introduction-to-object-oriented-programming.html#cb261-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span>
<span id="cb261-11"><a href="an-introduction-to-object-oriented-programming.html#cb261-11" aria-hidden="true" tabindex="-1"></a>my_ave<span class="sc">$</span>n   </span>
<span id="cb261-12"><a href="an-introduction-to-object-oriented-programming.html#cb261-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span>
<span id="cb261-13"><a href="an-introduction-to-object-oriented-programming.html#cb261-13" aria-hidden="true" tabindex="-1"></a>my_ave<span class="sc">$</span><span class="fu">update</span>(<span class="fl">3.</span>)  </span>
<span id="cb261-14"><a href="an-introduction-to-object-oriented-programming.html#cb261-14" aria-hidden="true" tabindex="-1"></a>my_ave<span class="sc">$</span>current_xbar</span>
<span id="cb261-15"><a href="an-introduction-to-object-oriented-programming.html#cb261-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2</span></span>
<span id="cb261-16"><a href="an-introduction-to-object-oriented-programming.html#cb261-16" aria-hidden="true" tabindex="-1"></a>my_ave<span class="sc">$</span>n   </span>
<span id="cb261-17"><a href="an-introduction-to-object-oriented-programming.html#cb261-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2</span></span></code></pre></div>
<p>Compare how similar this code looks to the code in <a href="an-introduction-to-object-oriented-programming.html#a-first-example">14.1.2</a>! Note the paucity of assignment operators, and plenty of side-effects.</p>
</div>
<div id="creating-r6-classes" class="section level3 hasAnchor" number="14.2.9">
<h3><span class="header-section-number">14.2.9</span> Creating R6 Classes<a href="an-introduction-to-object-oriented-programming.html#creating-r6-classes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I quickly implement the above example as an R6 class. A more detailed introduction to R6 classes is provided in <a href="https://r6.r-lib.org/articles/Introduction.html">the vignette from the package authors.</a></p>
<p>You’ll notice the reappearance of the <code>self</code> keyword. R6 classes have a <code>self</code> keyword just like in Python. They are similar to reference classes, but there are a few differences:</p>
<ol style="list-style-type: decimal">
<li>they have <a href="https://r6.r-lib.org/articles/Performance.html">better performance than reference classes</a>, and</li>
<li>they don’t make use of the <code>&lt;&lt;-</code> operator.</li>
</ol>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="an-introduction-to-object-oriented-programming.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R6)</span>
<span id="cb262-2"><a href="an-introduction-to-object-oriented-programming.html#cb262-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-3"><a href="an-introduction-to-object-oriented-programming.html#cb262-3" aria-hidden="true" tabindex="-1"></a>RunningMeanR6 <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&quot;RunningMeanR6&quot;</span>,</span>
<span id="cb262-4"><a href="an-introduction-to-object-oriented-programming.html#cb262-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">public =</span> <span class="fu">list</span>(</span>
<span id="cb262-5"><a href="an-introduction-to-object-oriented-programming.html#cb262-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">current_xbar =</span> <span class="cn">NULL</span>,</span>
<span id="cb262-6"><a href="an-introduction-to-object-oriented-programming.html#cb262-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">n =</span> <span class="cn">NULL</span>,</span>
<span id="cb262-7"><a href="an-introduction-to-object-oriented-programming.html#cb262-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">initialize =</span> <span class="cf">function</span>(<span class="at">current_xbar =</span> <span class="cn">NA</span>, <span class="at">n =</span> <span class="cn">NA</span>) {</span>
<span id="cb262-8"><a href="an-introduction-to-object-oriented-programming.html#cb262-8" aria-hidden="true" tabindex="-1"></a>                      self<span class="sc">$</span>current_xbar <span class="ot">&lt;-</span> current_xbar</span>
<span id="cb262-9"><a href="an-introduction-to-object-oriented-programming.html#cb262-9" aria-hidden="true" tabindex="-1"></a>                      self<span class="sc">$</span>n <span class="ot">&lt;-</span> n</span>
<span id="cb262-10"><a href="an-introduction-to-object-oriented-programming.html#cb262-10" aria-hidden="true" tabindex="-1"></a>                    },</span>
<span id="cb262-11"><a href="an-introduction-to-object-oriented-programming.html#cb262-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">update =</span> <span class="cf">function</span>(new_x) {</span>
<span id="cb262-12"><a href="an-introduction-to-object-oriented-programming.html#cb262-12" aria-hidden="true" tabindex="-1"></a>                      newSum <span class="ot">&lt;-</span> self<span class="sc">$</span>current_xbar<span class="sc">*</span>self<span class="sc">$</span>n <span class="sc">+</span> new_x</span>
<span id="cb262-13"><a href="an-introduction-to-object-oriented-programming.html#cb262-13" aria-hidden="true" tabindex="-1"></a>                      self<span class="sc">$</span>n <span class="ot">&lt;-</span> self<span class="sc">$</span>n <span class="sc">+</span> 1L</span>
<span id="cb262-14"><a href="an-introduction-to-object-oriented-programming.html#cb262-14" aria-hidden="true" tabindex="-1"></a>                      self<span class="sc">$</span>current_xbar <span class="ot">&lt;-</span> newSum <span class="sc">/</span> self<span class="sc">$</span>n</span>
<span id="cb262-15"><a href="an-introduction-to-object-oriented-programming.html#cb262-15" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb262-16"><a href="an-introduction-to-object-oriented-programming.html#cb262-16" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb262-17"><a href="an-introduction-to-object-oriented-programming.html#cb262-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb262-18"><a href="an-introduction-to-object-oriented-programming.html#cb262-18" aria-hidden="true" tabindex="-1"></a>my_r6_ave <span class="ot">&lt;-</span> RunningMeanR6<span class="sc">$</span><span class="fu">new</span>(<span class="at">current_xbar=</span><span class="dv">0</span>, <span class="at">n=</span>0L)</span>
<span id="cb262-19"><a href="an-introduction-to-object-oriented-programming.html#cb262-19" aria-hidden="true" tabindex="-1"></a>my_r6_ave</span>
<span id="cb262-20"><a href="an-introduction-to-object-oriented-programming.html#cb262-20" aria-hidden="true" tabindex="-1"></a><span class="do">## &lt;RunningMeanR6&gt;</span></span>
<span id="cb262-21"><a href="an-introduction-to-object-oriented-programming.html#cb262-21" aria-hidden="true" tabindex="-1"></a><span class="do">##   Public:</span></span>
<span id="cb262-22"><a href="an-introduction-to-object-oriented-programming.html#cb262-22" aria-hidden="true" tabindex="-1"></a><span class="do">##     clone: function (deep = FALSE) </span></span>
<span id="cb262-23"><a href="an-introduction-to-object-oriented-programming.html#cb262-23" aria-hidden="true" tabindex="-1"></a><span class="do">##     current_xbar: 0</span></span>
<span id="cb262-24"><a href="an-introduction-to-object-oriented-programming.html#cb262-24" aria-hidden="true" tabindex="-1"></a><span class="do">##     initialize: function (current_xbar = NA, n = NA) </span></span>
<span id="cb262-25"><a href="an-introduction-to-object-oriented-programming.html#cb262-25" aria-hidden="true" tabindex="-1"></a><span class="do">##     n: 0</span></span>
<span id="cb262-26"><a href="an-introduction-to-object-oriented-programming.html#cb262-26" aria-hidden="true" tabindex="-1"></a><span class="do">##     update: function (new_x)</span></span>
<span id="cb262-27"><a href="an-introduction-to-object-oriented-programming.html#cb262-27" aria-hidden="true" tabindex="-1"></a>my_r6_ave<span class="sc">$</span><span class="fu">update</span>(<span class="fl">1.</span>) </span>
<span id="cb262-28"><a href="an-introduction-to-object-oriented-programming.html#cb262-28" aria-hidden="true" tabindex="-1"></a>my_r6_ave<span class="sc">$</span>current_xbar</span>
<span id="cb262-29"><a href="an-introduction-to-object-oriented-programming.html#cb262-29" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span>
<span id="cb262-30"><a href="an-introduction-to-object-oriented-programming.html#cb262-30" aria-hidden="true" tabindex="-1"></a>my_r6_ave<span class="sc">$</span>n   </span>
<span id="cb262-31"><a href="an-introduction-to-object-oriented-programming.html#cb262-31" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span>
<span id="cb262-32"><a href="an-introduction-to-object-oriented-programming.html#cb262-32" aria-hidden="true" tabindex="-1"></a>my_r6_ave<span class="sc">$</span><span class="fu">update</span>(<span class="fl">3.</span>)  </span>
<span id="cb262-33"><a href="an-introduction-to-object-oriented-programming.html#cb262-33" aria-hidden="true" tabindex="-1"></a>my_r6_ave<span class="sc">$</span>current_xbar</span>
<span id="cb262-34"><a href="an-introduction-to-object-oriented-programming.html#cb262-34" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2</span></span>
<span id="cb262-35"><a href="an-introduction-to-object-oriented-programming.html#cb262-35" aria-hidden="true" tabindex="-1"></a>my_r6_ave<span class="sc">$</span>n   </span>
<span id="cb262-36"><a href="an-introduction-to-object-oriented-programming.html#cb262-36" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2</span></span></code></pre></div>
<!-- Now we can create a new object -->
<!-- ```{r, collapse = TRUE} -->
<!-- myAve <- new("RunningMean", n = 0, currentXbar = 0.0) -->
<!-- ``` -->
<!-- my_ave = RunningMean() # create running average object -->
<!-- my_ave.get_current_xbar() # no data yet! -->
<!-- my_ave.update(1.) # first data point -->
<!-- my_ave.get_current_xbar() # xbar_1 -->
<!-- my_ave.update(3.)  # second data point -->
<!-- my_ave.get_current_xbar()  #xbar_2 -->
<!-- my_ave.n   # my_ave.n instead of self.n -->
<!-- import numpy as np -->
<!-- class RunningCI(RunningMean): -->
<!--   """Updates a running average and gives you a known-variance confidence interval""" -->
<!--   def __init__(self, known_var): -->
<!--     super().__init__() -->
<!--     self.known_var = known_var -->
<!--   def get_current_interval(self): -->
<!--     if self.n == 0: -->
<!--       return None -->
<!--     else: -->
<!--       half_width = 1.96 * np.sqrt(self.known_var / self.n)   -->
<!--       return np.array([self.current_xbar - half_width, self.current_xbar + half_width]) -->
</div>
</div>
<div id="exercises-12" class="section level2 hasAnchor" number="14.3">
<h2><span class="header-section-number">14.3</span> Exercises<a href="an-introduction-to-object-oriented-programming.html#exercises-12" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="python-questions-11" class="section level3 hasAnchor" number="14.3.1">
<h3><span class="header-section-number">14.3.1</span> Python Questions<a href="an-introduction-to-object-oriented-programming.html#python-questions-11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>If you are interested in estimating a linear regression model, there is a <a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html"><code>LinearRegression</code> class</a> that you might consider using in the <code>sklearn.linear_model</code> submodule. In this lab, we will create something similar, but a little more simplified.</p>
<p>A simple linear regression model will take in <span class="math inline">\(n\)</span> independent variables <span class="math inline">\(x_1, \ldots, x_n\)</span>, and <span class="math inline">\(n\)</span> dependent variables <span class="math inline">\(y_1, \ldots, y_n\)</span>, and try to describe their relationship with a function:
<span class="math display">\[\begin{equation}
y_i = \beta_0 + \beta_1 x_i + \epsilon_i.
\end{equation}\]</span>
The coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are unknown, and so must be estimated with the data. Estimating the variance of the noise terms <span class="math inline">\(\epsilon_i\)</span> may also be of interest, but we do not concern ourselves with that here.</p>
<p>The formulas for the estimated slope (i.e. <span class="math inline">\(\hat{\beta}_1\)</span>) and the estimated intercept (i.e. <span class="math inline">\(\hat{\beta}_0\)</span>) are as follows:
<span class="math display">\[\begin{equation}
\hat{\beta}_1 = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i-\bar{y)}}{\sum_{j=1}^n (x_j - \bar{x})^2}
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
\hat{\beta}_0 = \bar{y} - \hat{\beta}_1\bar{x}.
\end{equation}\]</span></p>
<p>Create a class that performs simple linear regression.</p>
<ul>
<li>Name it <code>SimpleLinReg</code>.</li>
<li>Its <code>.__init__()</code> method should not take any additional parameters. It should set two data attributes/members <code>est_intercept</code> and <code>est_slope</code>, to <code>np.nan</code>.</li>
<li>Give it a <code>.fit()</code> method that takes in two 1-dimensional Numpy arrays. The first should be the array of independent values, and the second should be the set of dependent values.</li>
<li><code>.fit(x,y)</code> should not <code>return</code> anything, but it should store two data attributes/members: <code>est_intercept</code> and <code>est_slope</code>. Every time <code>.fit()</code> is called, it will re-calculate the coefficient/parameter estimates.</li>
<li>Give it a <code>.get_coeffs()</code> method. It should not make any changes to the data attributes/members of the class. It should simply <code>return</code> a Numpy array with the parameter estimates inside. Make the first element the estimated intercept, and the second element the estimated slope. If no such coefficients have been estimated at the time of its calling, it should return the same size array but with the initial <code>np.nan</code>s inside.</li>
</ul>
<p>After you’ve finished writing your first class, you can bask in the glory and run the following test code:</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb263-1"><a href="an-introduction-to-object-oriented-programming.html#cb263-1" aria-hidden="true" tabindex="-1"></a>mod <span class="op">=</span> SimpleLinReg()</span>
<span id="cb263-2"><a href="an-introduction-to-object-oriented-programming.html#cb263-2" aria-hidden="true" tabindex="-1"></a>mod.get_coeffs()</span>
<span id="cb263-3"><a href="an-introduction-to-object-oriented-programming.html#cb263-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">10</span>)</span>
<span id="cb263-4"><a href="an-introduction-to-object-oriented-programming.html#cb263-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> <span class="fl">.2</span> <span class="op">*</span> x <span class="op">+</span> np.random.normal(size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb263-5"><a href="an-introduction-to-object-oriented-programming.html#cb263-5" aria-hidden="true" tabindex="-1"></a>mod.fit(x,y)</span>
<span id="cb263-6"><a href="an-introduction-to-object-oriented-programming.html#cb263-6" aria-hidden="true" tabindex="-1"></a>mod.get_coeffs()</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>Reconsider the above question that asked you to write a class called <code>LinearRegression</code>.</p>
<ul>
<li>Write a new class called <code>LinearRegression2</code> that preserves all of the existing functionality of <code>LinearRegression</code>. Do this in a way that does not excessively copy and paste code from <code>LinearRegression</code>.</li>
<li>Give your new class a method called <code>.visualize()</code> that takes no arguments and plots the most recent data, the data most recently provided to <code>.fit()</code>, in a scatterplot with the estimated regression line superimposed.</li>
<li>Unfortunately, <code>LinearRegression().fit(x,y).get_coeffs()</code> will not return estimated regression coefficients. Give your new class this functionality. In other words, make <code>LinearRegression2().fit(x,y).get_coeffs()</code> spit out regression coefficients. Hint: the solution should only require one extra line of code, and it should involve the <code>self</code> keyword.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>Consider the following time series model <span class="citation">(<a href="#ref-West1989BayesianFA" role="doc-biblioref">West and Harrison 1989</a>)</span>
<span class="math display">\[\begin{equation}
y_t = \beta_t + \epsilon_t \\
\beta_t = \beta_{t-1} + w_t \\
\beta_1 = w_1
\end{equation}\]</span>
Here <span class="math inline">\(y_t\)</span> is observed time series data, each <span class="math inline">\(\epsilon_t\)</span> is measurement noise with variance <span class="math inline">\(V\)</span> and each <span class="math inline">\(w_t\)</span> is also noise but with variance <span class="math inline">\(W\)</span>. Think of <span class="math inline">\(\beta_t\)</span> as a time-varying regression coefficient.</p>
<p>Imagine our data are arriving sequentially. The <strong>Kalman Filter</strong> <span class="citation">(<a href="#ref-kalman_filt" role="doc-biblioref">Kalman 1960</a>)</span> cite provides an “optimal” estimate of each <span class="math inline">\(\beta_t\)</span> given all of the information we have up to time <span class="math inline">\(t\)</span>. What’s better is that the algorithm is recursive. Future estimates of <span class="math inline">\(\beta_t\)</span> will be easy to calculate given our estimates of <span class="math inline">\(\beta_{t-1}\)</span>.</p>
<p>Let’s call the mean of <span class="math inline">\(\beta_{t-1}\)</span> (given all the information up to time <span class="math inline">\(t-1\)</span>) <span class="math inline">\(m_{t-1}\)</span>, and the variance of <span class="math inline">\(\beta_{t-1}\)</span> (given all the information up to time <span class="math inline">\(t-1\)</span>) <span class="math inline">\(P_{t-1}\)</span>. Then the Kalman recursions for this particular model are</p>
<p><span class="math display">\[\begin{equation}
M_t = M_{t-1} + \left(\frac{P_{t-1} + W}{P_{t-1} + W+V} \right)(y_t - M_{t-1})
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
P_t = \left(1 - \frac{P_{t-1} + W}{P_{t-1} + W+V} \right)(P_{t-1} + W)
\end{equation}\]</span>
for <span class="math inline">\(t \ge 1\)</span>.</p>
<ul>
<li>Write a class called <code>TVIKalman</code> (TVI stands for time-varying intercept).</li>
<li>Have <code>TVIKalman</code> take two floating points in to its <code>.__init__()</code> method in this order: <code>V</code> and <code>W</code>. These two numbers are positive, and are the variance parameters of the model. Store these two numbers. Also, store <span class="math inline">\(0\)</span> and <span class="math inline">\(W+V\)</span> as members/attributes called <code>filter_mean</code> and <code>filter_variance</code>, respectively.</li>
<li>Give <code>TVIKalman</code> another method: <code>.update(yt)</code>. This function should not return anything, but it should update the filtering distribution’s mean and variance numbers, <code>filter_mean</code> and <code>filter_variance</code>, given a new data point.</li>
<li>Give <code>TVIKalman</code> another method: <code>.get_confidence_interval()</code>. It should not take any arguments, and it should return a length two Numpy array. The ordered elements of that array should be <span class="math inline">\(M_t\)</span> plus and minus two standard deviations–a standard deviation at time <span class="math inline">\(t\)</span> is <span class="math inline">\(\sqrt{P_t}\)</span>.</li>
<li>Create a <code>DataFrame</code> called <code>results</code> with the three columns called <code>yt</code>, <code>lower</code>, and <code>upper</code>. The last two columns should be a sequence of confidence intervals given to you by the method you wrote. The first column should contain the following data: <code>[-1.7037539, -0.5966818, -0.7061919, -0.1226606, -0.5431923]</code>. Plot all three columns in a single line plot. Initialize your Kalman Filter object with both <code>V</code> and <code>W</code> set equal to <span class="math inline">\(.5\)</span>.</li>
</ul>
</div>
<div id="r-questions-11" class="section level3 hasAnchor" number="14.3.2">
<h3><span class="header-section-number">14.3.2</span> R Questions<a href="an-introduction-to-object-oriented-programming.html#r-questions-11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>Which of the following classes in R produce objects that are mutable? Select all that apply: S3, S4, reference classes, and R6.</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>Which of the following classes in R produce objects that can have methods? Select all that apply: S3, S4, reference classes, and R6.</p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>Which of the following classes in R produce objects that can store data? Select all that apply: S3, S4, reference classes, and R6.</p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>Which of the following classes in R have encapsulated definitions? Select all that apply: S3, S4, reference classes, and R6.</p>
<ol start="5" style="list-style-type: decimal">
<li></li>
</ol>
<p>Which of the following classes in R have “slots”? Select all that apply: S3, S4, reference classes, and R6.</p>
<ol start="6" style="list-style-type: decimal">
<li></li>
</ol>
<p>Which of the following class systems in R is the newest? S3, S4, reference classes, or R6?</p>
<ol start="7" style="list-style-type: decimal">
<li></li>
</ol>
<p>Which of the following class systems in R is the oldest? S3, S4, reference classes, or R6?</p>
<ol start="8" style="list-style-type: decimal">
<li></li>
</ol>
<p>Which of the following classes in R requires you to <code>library()</code> in something? Select all that apply: S3, S4, reference classes, and R6.</p>
<ol start="9" style="list-style-type: decimal">
<li></li>
</ol>
<p>Suppose you have the following data set: <span class="math inline">\(X_1, \ldots, X_n\)</span>. You assume it is a random sample from a Normal distribution with unknown mean and variance parameters, denoted by <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span>, respectively. Consider testing the null hypothesis that <span class="math inline">\(\mu = 0\)</span> at a significance level of <span class="math inline">\(\alpha\)</span>. To carry out this test, you calculate
<span class="math display">\[\begin{equation}
t = \frac{\bar{X}}{S/\sqrt{n}}
\end{equation}\]</span>
and you reject the null hypothesis if <span class="math inline">\(|t| &gt; t_{n-1,\alpha/2}\)</span>. This is <strong>Student’s T-Test</strong> <span class="citation">(<a href="#ref-student1908probable" role="doc-biblioref">Student 1908</a>)</span>. Here <span class="math inline">\(S^2 = \sum_i(X_i - \bar{X})^2 / (n-1)\)</span> is the sample variance, and <span class="math inline">\(t_{n-1,\alpha/2}\)</span> is the <span class="math inline">\(1-\alpha/2\)</span> quantile of a t-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
<ul>
<li>Write a function called <code>doTTest()</code> that performs the above hypothesis test. It should accept two parameters: <code>dataVec</code> (a <code>vector</code> of data) and <code>significanceLevel</code> (which is <span class="math inline">\(\alpha\)</span>). Have the second parameter default to <code>.05</code>.</li>
<li>Have it return an S3 object created from a <code>list</code>. The <code>class</code> of this <code>list</code> should be <code>"TwoSidedTTest"</code>. The elements in the <code>list</code> should be named <code>decision</code> and <code>testStat</code>. The <code>decision</code> object should be either <code>"reject"</code> or <code>"fail to reject"</code>. The test stat should be equal to the calculation you made above for <span class="math inline">\(t\)</span>.</li>
<li>Create a <code>summary</code> method for this new class you created: <code>TwoSidedTTest</code>.</li>
</ul>
<ol start="10" style="list-style-type: decimal">
<li></li>
</ol>
<p>Suppose you have a target density <span class="math inline">\(p(x)\)</span> that you are only able to evaluate up to a normalizing constant. In other words, suppose that for some <span class="math inline">\(c &gt; 0\)</span>, <span class="math inline">\(p(x) = f(x) / c\)</span>, and you are only able to evaluate <span class="math inline">\(f(\cdot)\)</span>. Your goal is that you would like to be able to approximate the expected value of <span class="math inline">\(p(x)\)</span> (i.e. <span class="math inline">\(\int x p(x) dx\)</span>) using some proposal distribution <span class="math inline">\(q(x)\)</span>. <span class="math inline">\(q(x)\)</span> is flexible in that you can sample from it, and you can evaluate it. We will use <strong>importance sampling</strong> <span class="citation">(<a href="#ref-impsamping1" role="doc-biblioref">H. Kahn 1950b</a>)</span> <span class="citation">(<a href="#ref-impsamping2" role="doc-biblioref">H. Kahn 1950a</a>)</span> to achieve this.<a href="#fn26" class="footnote-ref" id="fnref26"><sup>26</sup></a></p>
<p><strong>Algorithm 1</strong>: Importance Sampling
i. Sample <span class="math inline">\(X^1, \ldots, X^n\)</span> from <span class="math inline">\(q(x)\)</span>,
ii. For each sample <span class="math inline">\(x^i\)</span>, calculate an unnormalized weight <span class="math inline">\(\tilde{w}^i:= \frac{f(x^i)}{q(x^i)}\)</span>,
iii. Calculate the normalized weights <span class="math inline">\(w^i = \tilde{w}^i \bigg/ \sum_j \tilde{w}^j\)</span>.
iv. Calculate the weighted average <span class="math inline">\(\sum_{i=1}^n w^i x^i\)</span>.</p>
<p>In practice it is beneficial to use log-densities, because it will avoid underflow issues. After you evaluate each <span class="math inline">\(\log \tilde{w}^i\)</span>, before you exponentiate them, subtract a number <span class="math inline">\(m\)</span> from all the values. A good choice for <span class="math inline">\(m\)</span> is <span class="math inline">\(\max_i (\log \tilde{w}^i)\)</span>. These new values will produce the same normalized weights because</p>
<p><span class="math display">\[\begin{equation}
w^i = \exp[ \log \tilde{w}^i - m] \bigg/ \sum_j \exp[\log \tilde{w}^j - m].
\end{equation}\]</span></p>
<ul>
<li>Create an R6 class called <code>ImpSamp</code> that performs importance sampling.</li>
<li>It should store function data values <code>qSamp</code>, <code>logQEval</code>, and <code>logFEval</code>.</li>
<li>Give it an <code>initialize()</code> method that takes in three arguments: <code>logFEvalFunc</code>, <code>qSampFunc</code> and <code>logQEvalFunc</code>.</li>
<li><code>initialize()</code> will set the stored function values equal to the function objects passed in.</li>
<li>The functions performing random sampling should only take a single argument referring to the number of samples desired.</li>
<li>The evaluation functions should take a <code>vector</code> as an input and return a <code>vector</code> as an output.</li>
<li>Write a method called <code>computeApproxExpec</code> that computes the importance sampling estimate of <span class="math inline">\(\int x p(x) dx\)</span>.</li>
<li>Is it better to make this code object-oriented, or would you prefer a simple function that spits out the answer? Why?</li>
</ul>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-cpm" class="csl-entry">
Brown, Taylor. 2021. <em>cPseudoMaRg: Constructs a Correlated Pseudo-Marginal Sampler</em>. <a href="https://CRAN.R-project.org/package=cPseudoMaRg">https://CRAN.R-project.org/package=cPseudoMaRg</a>.
</div>
<div id="ref-grolemund2014hands" class="csl-entry">
Grolemund, G. 2014. <em>Hands-on Programming with r: Write Your Own Functions and Simulations</em>. O’Reilly Media. <a href="https://books.google.com/books?id=S04BBAAAQBAJ">https://books.google.com/books?id=S04BBAAAQBAJ</a>.
</div>
<div id="ref-impsamping2" class="csl-entry">
Kahn, H. 1950a. <span>“Random Sampling (Monte Carlo) Techniques in Neutron Attenuation Problems. II.”</span> <em>Nucleonics (U.S.) Ceased Publication</em> Vol: 6, No. 6 (June). <a href="https://www.osti.gov/biblio/4399718">https://www.osti.gov/biblio/4399718</a>.
</div>
<div id="ref-impsamping1" class="csl-entry">
Kahn, H. 1950b. <span>“Random Sampling (Monte Carlo) Techniques in Neutron Attenuation Problems–i.”</span> <em>Nucleonics</em> 6 5.
</div>
<div id="ref-kalman_filt" class="csl-entry">
Kalman, R. E. 1960. <span>“<span class="nocase">A New Approach to Linear Filtering and Prediction Problems</span>.”</span> <em>Journal of Basic Engineering</em> 82 (1): 35–45. <a href="https://doi.org/10.1115/1.3662552">https://doi.org/10.1115/1.3662552</a>.
</div>
<div id="ref-student1908probable" class="csl-entry">
Student. 1908. <span>“The Probable Error of a Mean.”</span> <em>Biometrika</em>, 1–25.
</div>
<div id="ref-West1989BayesianFA" class="csl-entry">
West, Michael A., and Jeff Harrison. 1989. <span>“Bayesian Forecasting and Dynamic Models.”</span> In.
</div>
<div id="ref-wickham2014advanced" class="csl-entry">
Wickham, H. 2014. <em>Advanced r</em>. Chapman &amp; Hall/CRC the r Series. Taylor &amp; Francis. <a href="https://books.google.com/books?id=PFHFNAEACAAJ">https://books.google.com/books?id=PFHFNAEACAAJ</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="23">
<li id="fn23"><p>Just because you can do this, doesn’t mean you <em>should</em>, though!<a href="an-introduction-to-object-oriented-programming.html#fnref23" class="footnote-back">↩︎</a></p></li>
<li id="fn24"><p>Otherwise known as an independent and identically distributed sample<a href="an-introduction-to-object-oriented-programming.html#fnref24" class="footnote-back">↩︎</a></p></li>
<li id="fn25"><p>It’s defined as <span class="math inline">\(\hat{F}(x) = \frac{1}{n}\sum_{i=1}^n \mathbf{1}(X_i \le x)\)</span>.<a href="an-introduction-to-object-oriented-programming.html#fnref25" class="footnote-back">↩︎</a></p></li>
<li id="fn26"><p>Note that this is a similar setup to the accept-reject sampling problem we had earlier, and this algorithm is closely-related with the Monte Carlo algorithm we used in the exercises of chapter 3.<a href="an-introduction-to-object-oriented-programming.html#fnref26" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="visualization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="an-introduction-to-functional-programming.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tbrown122387/r_and_python_book/edit/master/14-oop.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
